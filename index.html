<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimate Real-Time Case Counts and Time-Varying Epidemiological Parameters  â€¢ EpiNow2</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Estimate Real-Time Case Counts and Time-Varying Epidemiological Parameters ">
<meta property="og:description" content="Estimates the time-varying reproduction number, rate of spread,
             and doubling time using a range of open-source tools (Abbott et al. &lt;doi:10.12688/wellcomeopenres.16006.1&gt;),
             and current best practices (Gostic et al. &lt;doi:10.1101/2020.06.18.20134858&gt;). 
             It aims to help users avoid some of the limitations of naive implementations in a framework
             that is informed by community feedback and is under active development.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">EpiNow2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
<li>
  <a href="reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/epiforecasts/EpiNow2">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="epinow2-estimate-real-time-case-counts-and-time-varying-epidemiological-parameters" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#epinow2-estimate-real-time-case-counts-and-time-varying-epidemiological-parameters" class="anchor"></a>EpiNow2: Estimate real-time case counts and time-varying epidemiological parameters</h1></div>

<p>This package estimates the time-varying reproduction number, rate of spread, and doubling time using a range of open-source tools (<a href="https://doi.org/10.12688/wellcomeopenres.16006.1">Abbott et al.</a>), and current best practices (<a href="https://doi.org/10.1101/2020.06.18.20134858">Gostic et al.</a>). It aims to help users avoid some of the limitations of naive implementations in a framework that is informed by community feedback and is under active development. It estimates the time-varying reproduction number on cases by date of infection (using a similar approach to that implemented in the <a href="https://github.com/annecori/EpiEstim"><code>{EpiEstim}</code></a>). Imputed infections are then mapped to observed data (for example cases by date of report) via a series of uncertain delay distributions (in the examples in the package documentation these are an incubation period and a reporting delay) and a reporting model that can include weekly periodicity. The default model uses a non-stationary Gaussian process to estimate the time-varying reproduction number but optionally a stationary Gaussian process may be used (faster to estimate but reduced performance for real time estimates) and arbitrary breakpoints can be defined. A fixed reproduction number is also supported. When combined with user defined breakpoints this gives the option of modelling the time-varying reproduction number as piecewise linear. The documentation for <a href="https://epiforecasts.io/EpiNow2/reference/estimate_infections.html"><code>estimate_infections</code></a> provides examples of the different options available. Propagating uncertainty from all inputs into the final parameter estimates (helping to mitigate spurious findings) is handled internally. Time-varying estimates of the rate of growth are derived from the time-varying reproduction estimates and the uncertain generation time. Optionally, the time-varying reproduction number can be forecast forwards in time using an integration with the <a href="https://epiforecasts.io/EpiSoon"><code>{EpiSoon}</code></a> package and converted to a case forecast using the renewal equation. Alternatively, the time-varying reproduction number and cases can be forecast using a Gaussian process. As a standalone tool non-parametric back-calculation is also supported using a novel formulation based on a smoothed mean delay shift of reported cases combined with a Gaussian process to determine the most likely outbreak trajectory.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Install the stable version of the package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"EpiNow2"</span>)
</pre></div>
<p>Install the stable development version of the package using <a href="https://epiforecasts.io/drat/"><code>{drat}</code></a>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"drat"</span>)
<span class="kw">drat</span>:::<span class="fu">add</span>(<span class="st">"epiforecasts"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"EpiNow2"</span>)
</pre></div>
<p>Install the unstable development version of the package with:</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw">remotes</span>::<span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span>(<span class="st">"epiforecasts/EpiNow2"</span>)
</pre></div>
<p>Windows users will need a working installation of Rtools in order to build the package from source. See <a href="https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#checking-the-c-toolchain">here</a> for a guide to installing Rtools for use with Stan (which is the statistical modeling platform used for the underlying model). For simple deployment/development a prebuilt docker image is also available (see documentation <a href="https://github.com/epiforecasts/EpiNow2/wiki/Docker">here</a>).</p>
</div>
<div id="quick-start" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-start" class="anchor"></a>Quick start</h2>
<p><code>{EpiNow}</code> is designed to be used with a single function call or to be used in an ad-hoc fashion via individual function calls. In the following section we give an overview of the simple use case. For more on using each function see the <a href="https://epiforecasts.io/EpiNow2/reference/index.html">function documentation</a>. The core functions are: <a href="https://epiforecasts.io/EpiNow2/reference/epinow.html"><code>epinow</code></a>, <a href="https://epiforecasts.io/EpiNow2/reference/epinow.html"><code>regional_epinow</code></a>, <a href="https://epiforecasts.io/EpiNow2/reference/estimate_infections.html"><code>estimate_infections</code></a>, and <a href="https://epiforecasts.io/EpiNow2/reference/forecast_infections.html"><code>forecast_infections</code></a>. <a href="https://epiforecasts.io/EpiNow2/reference/estimate_infections.html"><code>estimate_infections</code></a> can be use on its own to infer the underlying infection case curve from reported cases with Rt optionally returned (on by default). Estimating the underlying infection case curve alone is substantially less computationally demanding than also estimating Rt.</p>
<div id="reporting-delays-incubation-period-and-generation-time" class="section level3">
<h3 class="hasAnchor">
<a href="#reporting-delays-incubation-period-and-generation-time" class="anchor"></a>Reporting delays, incubation period and generation time</h3>
<p>Distributions can either be fitted using package functionality or determined elsewhere and then defined with uncertainty for use in <code>{EpiNow2}</code>. When data is supplied a subsampled bootstrapped lognormal will be fit (to account for uncertainty in the observed data without being biased by changes in incidence). An arbitrary number of delay distributions are supported with the most common use case likely to be a incubation period followed by a reporting delay.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="kw">reporting_delay</span> <span class="op">&lt;-</span> <span class="kw">EpiNow2</span>::<span class="fu"><a href="reference/bootstrapped_dist_fit.html">bootstrapped_dist_fit</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html">rlnorm</a></span>(<span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="fl">6</span>), <span class="fl">1</span>))
<span class="co">## Set max allowed delay to 30 days to truncate computation</span>
<span class="kw">reporting_delay</span><span class="op">$</span><span class="kw">max</span> <span class="op">&lt;-</span> <span class="fl">30</span>

<span class="kw">reporting_delay</span>
<span class="co">#&gt; $mean</span>
<span class="co">#&gt; [1] 1.526777</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mean_sd</span>
<span class="co">#&gt; [1] 0.1187874</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd</span>
<span class="co">#&gt; [1] 1.018014</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd_sd</span>
<span class="co">#&gt; [1] 0.1281687</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max</span>
<span class="co">#&gt; [1] 30</span>
</pre></div>
<p>Here we define the incubation period and generation time based on literature estimates for Covid-19 (see <a href="https://github.com/epiforecasts/EpiNow/tree/master/data-raw">here</a> for the code that generates these estimates).</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="kw">generation_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(mean = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">mean</span>,
                        mean_sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">mean_sd</span>,
                         sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">sd</span>,
                         sd_sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">sd_sd</span>,
                         max = <span class="fl">30</span>)

<span class="kw">incubation_period</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(mean = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">mean</span>,
                          mean_sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">mean_sd</span>,
                          sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">sd</span>,
                          sd_sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">sd_sd</span>,
                          max = <span class="fl">30</span>)
</pre></div>
</div>
<div id="epinow" class="section level3">
<h3 class="hasAnchor">
<a href="#epinow" class="anchor"></a><a href="https://epiforecasts.io/EpiNow2/reference/epinow.html">epinow</a>
</h3>
<p>This function represents the core functionality of the package and includes results reporting, plotting and optional saving. It requires a data frame of cases by date of report and the distributions defined above. An additional forecasting module is supported via <code>EpiSoon</code> and companion packages (see documentation for an example).</p>
<p>Load example case data from <code>{EpiNow2}</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="kw">reported_cases</span> <span class="op">&lt;-</span> <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/example_confirmed.html">example_confirmed</a></span>[<span class="fl">1</span><span class="op">:</span><span class="fl">50</span>]

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">reported_cases</span>)
<span class="co">#&gt;          date confirm</span>
<span class="co">#&gt; 1: 2020-02-22      14</span>
<span class="co">#&gt; 2: 2020-02-23      62</span>
<span class="co">#&gt; 3: 2020-02-24      53</span>
<span class="co">#&gt; 4: 2020-02-25      97</span>
<span class="co">#&gt; 5: 2020-02-26      93</span>
<span class="co">#&gt; 6: 2020-02-27      78</span>
</pre></div>
<p>Estimate cases by date of infection, the time-varying reproduction number, the rate of growth and forecast these estimates into the future by 7 days. Summarise the posterior and return a summary table and plots for reporting purposes. If a <code>target_folder</code> is supplied results can be internally saved (with the option to also turn off explicit returning of results). <em>Note that for real use cases more samples and a longer warm up may be needed</em>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="kw">estimates</span> <span class="op">&lt;-</span> <span class="kw">EpiNow2</span>::<span class="fu"><a href="reference/epinow.html">epinow</a></span>(reported_cases = <span class="kw">reported_cases</span>, 
                             generation_time = <span class="kw">generation_time</span>,
                             delays = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">incubation_period</span>, <span class="kw">reporting_delay</span>),
                             horizon = <span class="fl">7</span>, samples = <span class="fl">1000</span>, warmup = <span class="fl">200</span>, 
                             cores = <span class="fl">4</span>, chains = <span class="fl">4</span>, verbose = <span class="fl">TRUE</span>, 
                             adapt_delta = <span class="fl">0.95</span>)

<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">estimates</span>)
<span class="co">#&gt; [1] "estimates"                "estimated_reported_cases"</span>
<span class="co">#&gt; [3] "summary"                  "plots"</span>
</pre></div>
<p>Both summary measures and posterior samples are returned for all parameters in an easily explored format.</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">estimates</span>
<span class="co">#&gt; $samples</span>
<span class="co">#&gt;                 variable        parameter time       date sample       value</span>
<span class="co">#&gt;      1:       infections       infections    1 2020-02-09      1    1.750261</span>
<span class="co">#&gt;      2:       infections       infections    2 2020-02-10      1   12.116275</span>
<span class="co">#&gt;      3:       infections       infections    3 2020-02-11      1   20.973398</span>
<span class="co">#&gt;      4:       infections       infections    4 2020-02-12      1   33.235345</span>
<span class="co">#&gt;      5:       infections       infections    5 2020-02-13      1   50.846664</span>
<span class="co">#&gt;     ---                                                                     </span>
<span class="co">#&gt; 254066: prior_infections prior_infections   66 2020-04-14      1 2714.255263</span>
<span class="co">#&gt; 254067: prior_infections prior_infections   67 2020-04-15      1 2647.130393</span>
<span class="co">#&gt; 254068: prior_infections prior_infections   68 2020-04-16      1 2581.665553</span>
<span class="co">#&gt; 254069: prior_infections prior_infections   69 2020-04-17      1 2517.819692</span>
<span class="co">#&gt; 254070: prior_infections prior_infections   70 2020-04-18      1 2455.552770</span>
<span class="co">#&gt;         strat     type</span>
<span class="co">#&gt;      1:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;      2:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;      3:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;      4:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;      5:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;     ---               </span>
<span class="co">#&gt; 254066:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; 254067:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; 254068:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; 254069:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; 254070:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summarised</span>
<span class="co">#&gt;            date       variable strat     type     bottom         top</span>
<span class="co">#&gt;   1: 2020-02-22              R  &lt;NA&gt; estimate   1.013607    1.634806</span>
<span class="co">#&gt;   2: 2020-02-23              R  &lt;NA&gt; estimate   1.126032    1.628409</span>
<span class="co">#&gt;   3: 2020-02-24              R  &lt;NA&gt; estimate   1.239503    1.632852</span>
<span class="co">#&gt;   4: 2020-02-25              R  &lt;NA&gt; estimate   1.302263    1.627336</span>
<span class="co">#&gt;   5: 2020-02-26              R  &lt;NA&gt; estimate   1.405565    1.675343</span>
<span class="co">#&gt;  ---                                                                </span>
<span class="co">#&gt; 320: 2020-04-14 reported_cases  &lt;NA&gt; forecast 625.000000 6101.000000</span>
<span class="co">#&gt; 321: 2020-04-15 reported_cases  &lt;NA&gt; forecast 575.000000 5209.000000</span>
<span class="co">#&gt; 322: 2020-04-16 reported_cases  &lt;NA&gt; forecast 544.000000 7177.000000</span>
<span class="co">#&gt; 323: 2020-04-17 reported_cases  &lt;NA&gt; forecast 652.000000 8107.000000</span>
<span class="co">#&gt; 324: 2020-04-18 reported_cases  &lt;NA&gt; forecast 454.000000 7528.000000</span>
<span class="co">#&gt;            lower       upper      median        mean           sd</span>
<span class="co">#&gt;   1:    1.178451    1.421593    1.339590    1.330223 1.850986e-01</span>
<span class="co">#&gt;   2:    1.259853    1.462121    1.377084    1.375055 1.527293e-01</span>
<span class="co">#&gt;   3:    1.334916    1.494135    1.422152    1.425275 1.231917e-01</span>
<span class="co">#&gt;   4:    1.402532    1.528534    1.477543    1.479545 9.865963e-02</span>
<span class="co">#&gt;   5:    1.470801    1.575832    1.530933    1.536156 8.252993e-02</span>
<span class="co">#&gt;  ---                                                             </span>
<span class="co">#&gt; 320: 1366.000000 3220.000000 2829.500000 3393.952000 2.299540e+03</span>
<span class="co">#&gt; 321: 1101.000000 2620.000000 2367.500000 2973.355000 2.680636e+03</span>
<span class="co">#&gt; 322: 1129.000000 2921.000000 2640.500000 3642.206000 3.842833e+03</span>
<span class="co">#&gt; 323: 1473.000000 3729.000000 3170.500000 5226.641000 1.567632e+04</span>
<span class="co">#&gt; 324: 1019.000000 2762.000000 2443.500000 5387.408000 2.755609e+04</span>
</pre></div>
<p>Reported cases are returned separately in order to ease reporting of forecasts and model evaluation.</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">estimated_reported_cases</span>
<span class="co">#&gt; $samples</span>
<span class="co">#&gt;              date sample cases  type</span>
<span class="co">#&gt;     1: 2020-02-22      1    57 gp_rt</span>
<span class="co">#&gt;     2: 2020-02-23      1    88 gp_rt</span>
<span class="co">#&gt;     3: 2020-02-24      1   138 gp_rt</span>
<span class="co">#&gt;     4: 2020-02-25      1   117 gp_rt</span>
<span class="co">#&gt;     5: 2020-02-26      1   141 gp_rt</span>
<span class="co">#&gt;    ---                              </span>
<span class="co">#&gt; 56996: 2020-04-14   1000  1206 gp_rt</span>
<span class="co">#&gt; 56997: 2020-04-15   1000   907 gp_rt</span>
<span class="co">#&gt; 56998: 2020-04-16   1000  1143 gp_rt</span>
<span class="co">#&gt; 56999: 2020-04-17   1000  2382 gp_rt</span>
<span class="co">#&gt; 57000: 2020-04-18   1000  1847 gp_rt</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summarised</span>
<span class="co">#&gt;           date  type bottom   top lower upper median     mean          sd</span>
<span class="co">#&gt;  1: 2020-02-22 gp_rt     34   153    43    88   81.0   88.586    39.65505</span>
<span class="co">#&gt;  2: 2020-02-23 gp_rt     40   203    72   134  116.0  126.097    55.10023</span>
<span class="co">#&gt;  3: 2020-02-24 gp_rt     45   244    88   162  139.5  150.251    66.05259</span>
<span class="co">#&gt;  4: 2020-02-25 gp_rt     54   264    89   172  146.0  155.772    70.09574</span>
<span class="co">#&gt;  5: 2020-02-26 gp_rt     43   253    83   161  140.0  152.781    69.60690</span>
<span class="co">#&gt;  6: 2020-02-27 gp_rt     68   343   114   221  189.0  203.793    92.92878</span>
<span class="co">#&gt;  7: 2020-02-28 gp_rt     85   468   184   337  276.0  290.370   125.67080</span>
<span class="co">#&gt;  8: 2020-02-29 gp_rt     81   431   139   275  252.5  267.204   116.88049</span>
<span class="co">#&gt;  9: 2020-03-01 gp_rt    113   596   186   378  321.0  353.678   164.78594</span>
<span class="co">#&gt; 10: 2020-03-02 gp_rt    141   699   225   431  371.5  412.765   189.37183</span>
<span class="co">#&gt; 11: 2020-03-03 gp_rt    125   702   209   441  388.0  420.190   203.38732</span>
<span class="co">#&gt; 12: 2020-03-04 gp_rt    140   714   234   461  397.0  429.156   196.69349</span>
<span class="co">#&gt; 13: 2020-03-05 gp_rt    245  1044   329   644  566.5  609.139   266.42624</span>
<span class="co">#&gt; 14: 2020-03-06 gp_rt    300  1490   438   896  808.0  871.336   397.23481</span>
<span class="co">#&gt; 15: 2020-03-07 gp_rt    291  1450   482   920  803.5  873.307   398.43175</span>
<span class="co">#&gt; 16: 2020-03-08 gp_rt    389  1925   731  1268 1069.0 1158.306   538.96552</span>
<span class="co">#&gt; 17: 2020-03-09 gp_rt    428  2255   707  1385 1263.5 1351.991   594.49812</span>
<span class="co">#&gt; 18: 2020-03-10 gp_rt    460  2425   794  1542 1358.0 1461.580   652.64810</span>
<span class="co">#&gt; 19: 2020-03-11 gp_rt    555  2443   811  1554 1346.0 1476.827   652.37897</span>
<span class="co">#&gt; 20: 2020-03-12 gp_rt    677  3227  1064  2121 1861.5 1992.058   865.29130</span>
<span class="co">#&gt; 21: 2020-03-13 gp_rt    996  4773  1635  3142 2718.5 2881.378  1326.69167</span>
<span class="co">#&gt; 22: 2020-03-14 gp_rt   1002  4630  1677  2932 2456.0 2708.254  1174.37006</span>
<span class="co">#&gt; 23: 2020-03-15 gp_rt   1146  5529  2048  3786 3201.5 3447.779  1570.34310</span>
<span class="co">#&gt; 24: 2020-03-16 gp_rt   1393  6512  2386  4414 3591.5 3908.992  1769.31798</span>
<span class="co">#&gt; 25: 2020-03-17 gp_rt   1267  6572  2146  4104 3522.5 3846.382  1768.97474</span>
<span class="co">#&gt; 26: 2020-03-18 gp_rt   1179  5910  2047  3884 3261.0 3526.138  1602.86542</span>
<span class="co">#&gt; 27: 2020-03-19 gp_rt   1440  7407  2139  4466 4021.5 4431.678  2072.42123</span>
<span class="co">#&gt; 28: 2020-03-20 gp_rt   1755  8992  3576  6416 5200.0 5559.238  2385.59600</span>
<span class="co">#&gt; 29: 2020-03-21 gp_rt   1519  8141  2969  5542 4681.0 5032.791  2181.88502</span>
<span class="co">#&gt; 30: 2020-03-22 gp_rt   1840  9560  3086  6237 5578.0 5932.509  2629.45578</span>
<span class="co">#&gt; 31: 2020-03-23 gp_rt   2257 10286  3558  6721 5520.5 5981.983  2663.74716</span>
<span class="co">#&gt; 32: 2020-03-24 gp_rt   1794  8990  2868  5572 4922.5 5387.801  2478.20195</span>
<span class="co">#&gt; 33: 2020-03-25 gp_rt   1774  8025  2659  5043 4286.0 4616.990  2072.41513</span>
<span class="co">#&gt; 34: 2020-03-26 gp_rt   1863  8767  2942  5631 4942.0 5453.010  2427.70123</span>
<span class="co">#&gt; 35: 2020-03-27 gp_rt   1888 10857  3489  6830 6036.5 6570.360  2997.09143</span>
<span class="co">#&gt; 36: 2020-03-28 gp_rt   1851  8998  3172  6144 5025.5 5376.933  2437.79923</span>
<span class="co">#&gt; 37: 2020-03-29 gp_rt   1983  9871  3400  6457 5648.5 6005.764  2573.58254</span>
<span class="co">#&gt; 38: 2020-03-30 gp_rt   2041  9421  3431  6567 5408.5 5809.676  2567.23470</span>
<span class="co">#&gt; 39: 2020-03-31 gp_rt   1747  8559  3116  5642 4738.5 5127.833  2258.63751</span>
<span class="co">#&gt; 40: 2020-04-01 gp_rt   1606  7108  2383  4553 3924.0 4296.909  1977.72808</span>
<span class="co">#&gt; 41: 2020-04-02 gp_rt   1513  8280  2224  4900 4498.5 4926.810  2324.42789</span>
<span class="co">#&gt; 42: 2020-04-03 gp_rt   2167  9460  2937  5920 5333.0 5731.218  2532.78712</span>
<span class="co">#&gt; 43: 2020-04-04 gp_rt   1602  7402  2289  4646 4257.0 4565.501  1939.39160</span>
<span class="co">#&gt; 44: 2020-04-05 gp_rt   1586  8016  2952  5586 4645.5 5011.806  2335.28577</span>
<span class="co">#&gt; 45: 2020-04-06 gp_rt   1590  7765  2800  5123 4370.5 4646.726  2030.21003</span>
<span class="co">#&gt; 46: 2020-04-07 gp_rt    994  6722  2159  4192 3690.5 4067.877  1890.74353</span>
<span class="co">#&gt; 47: 2020-04-08 gp_rt   1306  5785  2260  3937 3162.5 3382.271  1484.56436</span>
<span class="co">#&gt; 48: 2020-04-09 gp_rt   1085  6441  2192  4147 3574.5 3929.648  1872.83467</span>
<span class="co">#&gt; 49: 2020-04-10 gp_rt   1386  7599  2728  5052 4165.0 4569.607  2110.62085</span>
<span class="co">#&gt; 50: 2020-04-11 gp_rt   1014  5890  2096  3996 3304.0 3596.222  1760.53789</span>
<span class="co">#&gt; 51: 2020-04-12 gp_rt   1071  6923  2036  4136 3591.0 4066.375  2134.61476</span>
<span class="co">#&gt; 52: 2020-04-13 gp_rt   1006  6982  1706  3851 3421.5 3915.560  2423.14807</span>
<span class="co">#&gt; 53: 2020-04-14 gp_rt    625  6101  1366  3220 2829.5 3393.952  2299.53973</span>
<span class="co">#&gt; 54: 2020-04-15 gp_rt    575  5209  1101  2620 2367.5 2973.355  2680.63628</span>
<span class="co">#&gt; 55: 2020-04-16 gp_rt    544  7177  1129  2921 2640.5 3642.206  3842.83278</span>
<span class="co">#&gt; 56: 2020-04-17 gp_rt    652  8107  1473  3729 3170.5 5226.641 15676.32300</span>
<span class="co">#&gt; 57: 2020-04-18 gp_rt    454  7528  1019  2762 2443.5 5387.408 27556.09256</span>
<span class="co">#&gt;           date  type bottom   top lower upper median     mean          sd</span>
</pre></div>
<p>A summary table is returned for rapidly understanding the results and for reporting purposes.</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">summary</span>
<span class="co">#&gt;                                  measure             estimate  numeric_estimate</span>
<span class="co">#&gt; 1: New confirmed cases by infection date   2407 (121 -- 7474) &lt;data.table[1x5]&gt;</span>
<span class="co">#&gt; 2:        Expected change in daily cases               Unsure               0.7</span>
<span class="co">#&gt; 3:            Effective reproduction no.     0.8 (0.3 -- 1.4) &lt;data.table[1x5]&gt;</span>
<span class="co">#&gt; 4:                        Rate of growth -0.05 (-0.2 -- 0.11) &lt;data.table[1x5]&gt;</span>
<span class="co">#&gt; 5:          Doubling/halving time (days)  -13.5 (6.2 -- -3.5) &lt;data.table[1x3]&gt;</span>
</pre></div>
<p>A range of plots are returned (with the single summary plot shown below).</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">plots</span><span class="op">$</span><span class="kw">summary</span>
</pre></div>
<p><img src="reference/figures/unnamed-chunk-12-1.png"><!-- --></p>
</div>
<div id="regional-epinow" class="section level3">
<h3 class="hasAnchor">
<a href="#regional-epinow" class="anchor"></a><a href="https://epiforecasts.io/EpiNow2/reference/regional_epinow.html">Regional epinow</a>
</h3>
<p>This function runs the the <code>epinow</code> function across multiple regions in an efficient manner.</p>
<p>Define cases in multiple regions delineated by the region variable.</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="kw">reported_cases</span> <span class="op">&lt;-</span> <span class="kw">data.table</span>::<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbindlist</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
   <span class="kw">data.table</span>::<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html">copy</a></span>(<span class="kw">reported_cases</span>)[, <span class="kw">region</span> <span class="op">:=</span> <span class="st">"testland"</span>],
   <span class="kw">reported_cases</span>[, <span class="kw">region</span> <span class="op">:=</span> <span class="st">"realland"</span>]))

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">reported_cases</span>)
<span class="co">#&gt;          date confirm   region</span>
<span class="co">#&gt; 1: 2020-02-22      14 testland</span>
<span class="co">#&gt; 2: 2020-02-23      62 testland</span>
<span class="co">#&gt; 3: 2020-02-24      53 testland</span>
<span class="co">#&gt; 4: 2020-02-25      97 testland</span>
<span class="co">#&gt; 5: 2020-02-26      93 testland</span>
<span class="co">#&gt; 6: 2020-02-27      78 testland</span>
</pre></div>
<p>Run the pipeline on each region in turn. The commented code (requires the <code>{future}</code> package) can be used to run regions in parallel (when in most scenarios <code>cores</code> should be set to 1).</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="co">## future::plan("multisession")</span>
<span class="kw">estimates</span> <span class="op">&lt;-</span> <span class="kw">EpiNow2</span>::<span class="fu"><a href="reference/regional_epinow.html">regional_epinow</a></span>(reported_cases = <span class="kw">reported_cases</span>, 
                                      generation_time = <span class="kw">generation_time</span>,
                                      delays = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">incubation_period</span>, <span class="kw">reporting_delay</span>),
                                      horizon = <span class="fl">7</span>, samples = <span class="fl">1000</span>, warmup = <span class="fl">200</span>,
                                      cores = <span class="fl">4</span>, chains = <span class="fl">4</span>, adapt_delta = <span class="fl">0.95</span>,
                                      verbose = <span class="fl">TRUE</span>)
</pre></div>
<p>Results from each region are stored in a <code>regional</code> list with across region summary measures and plots stored in a <code>summary</code> list. All results can be set to be internally saved by setting the <code>target_folder</code> and <code>summary_dir</code> arguments.</p>
<p>Summary measures that are returned include a table formatted for reporting (along with raw results for further processing).</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">summary</span><span class="op">$</span><span class="kw">summarised_results</span><span class="op">$</span><span class="kw">table</span>
<span class="co">#&gt;      Region New confirmed cases by infection date</span>
<span class="co">#&gt; 1: realland                     2402 (97 -- 7486)</span>
<span class="co">#&gt; 2: testland                    2474 (114 -- 7527)</span>
<span class="co">#&gt;    Expected change in daily cases Effective reproduction no.</span>
<span class="co">#&gt; 1:                         Unsure           0.8 (0.3 -- 1.4)</span>
<span class="co">#&gt; 2:                         Unsure           0.8 (0.3 -- 1.4)</span>
<span class="co">#&gt;           Rate of growth Doubling/halving time (days)</span>
<span class="co">#&gt; 1: -0.05 (-0.21 -- 0.12)          -13.4 (5.7 -- -3.3)</span>
<span class="co">#&gt; 2: -0.05 (-0.23 -- 0.11)            -14.3 (6.4 -- -3)</span>
</pre></div>
<p>A range of plots are again returned (with the single summary plot shown below).</p>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">summary</span><span class="op">$</span><span class="kw">summary_plot</span>
</pre></div>
<p><img src="reference/figures/unnamed-chunk-16-1.png"><!-- --></p>
</div>
<div id="reporting-templates" class="section level3">
<h3 class="hasAnchor">
<a href="#reporting-templates" class="anchor"></a>Reporting templates</h3>
<p>Rmarkdown templates are provided in the package (<code>templates</code>) for semi-automated reporting of estimates. These are currently undocumented but an example integration can be seen <a href="https://github.com/epiforecasts/covid/blob/master/_posts/national/united-kingdom/united-kingdom.Rmd">here</a>. If using these templates to report your results please highlight our <a href="https://epiforecasts.io/covid/">limitations</a> as these are key to understanding our results.</p>
</div>
</div>
<div id="contributing" class="section level2">
<h2 class="hasAnchor">
<a href="#contributing" class="anchor"></a>Contributing</h2>
<p>File an issue <a href="https://github.com/epiforecasts/EpiNow2/issues">here</a> if you have identified an issue with the package. Please note that due to operational constraints priority will be given to users informing government policy or offering methodological insights. We welcome all contributions, in particular those that improve the approach or the robustness of the code base.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Sam Abbott <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-8057-8037" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Joel Hellewell <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-2683-0849" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Robin Thompson <br><small class="roles"> Author </small>  </li>
<li>Katelyn Gostic <br><small class="roles"> Author </small>  </li>
<li>Katharine Sherratt <br><small class="roles"> Author </small>  </li>
<li>Sophie Meakin <br><small class="roles"> Author </small>  </li>
<li>James Munday <br><small class="roles"> Author </small>  </li>
<li>Nikos Bosse <br><small class="roles"> Author </small>  </li>
<li>Paul Mee <br><small class="roles"> Author </small>  </li>
<li>EpiForecasts <br><small class="roles"> Author </small>  </li>
<li>Sebastian Funk <br><small class="roles"> Author </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/epiforecasts/EpiNow2/actions"><img src="https://github.com/epiforecasts/EpiNow2/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://codecov.io/gh/epiforecasts/EpiNow2?branch=master"><img src="https://codecov.io/gh/epiforecasts/EpiNow2/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://zenodo.org/badge/latestdoi/272995211"><img src="https://zenodo.org/badge/272995211.svg" alt="DOI"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Sam Abbott, Joel Hellewell, Robin Thompson, Katelyn Gostic, Katharine Sherratt, Sophie Meakin, James Munday, Nikos Bosse, Paul Mee, EpiForecasts, Sebastian Funk.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
