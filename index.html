<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimate Real-Time Case Counts and Time-Varying Epidemiological Parameters â€¢ EpiNow2</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Estimate Real-Time Case Counts and Time-Varying Epidemiological Parameters">
<meta property="og:description" content="Estimates the time-varying reproduction number, rate of spread,
             and doubling time using a range of open-source tools (Abbott et al. (2020) &lt;doi:10.12688/wellcomeopenres.16006.1&gt;),
             and current best practices (Gostic et al. (2020) &lt;doi:10.1101/2020.06.18.20134858&gt;).
             It aims to help users avoid some of the limitations of naive implementations in a framework
             that is informed by community feedback and is under active development.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">EpiNow2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
<li>
  <a href="reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/epiforecasts/EpiNow2">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="epinow2-estimate-real-time-case-counts-and-time-varying-epidemiological-parameters" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#epinow2-estimate-real-time-case-counts-and-time-varying-epidemiological-parameters" class="anchor"></a>EpiNow2: Estimate real-time case counts and time-varying epidemiological parameters</h1></div>

<p>This package estimates the time-varying reproduction number, rate of spread, and doubling time using a range of open-source tools (<a href="https://doi.org/10.12688/wellcomeopenres.16006.1">Abbott et al.</a>), and current best practices (<a href="https://doi.org/10.1101/2020.06.18.20134858">Gostic et al.</a>). It aims to help users avoid some of the limitations of naive implementations in a framework that is informed by community feedback and is under active development.</p>
<p>It estimates the time-varying reproduction number on cases by date of infection (using a similar approach to that implemented in the <a href="https://github.com/mrc-ide/EpiEstim"><code>{EpiEstim}</code></a>). Imputed infections are then mapped to observed data (for example cases by date of report) via a series of uncertain delay distributions (in the examples in the package documentation these are an incubation period and a reporting delay) and a reporting model that can include weekly periodicity.</p>
<p>Uncertainty is propagated from all inputs into the final parameter estimates, helping to mitigate spurious findings. This is handled internally. The time-varying reproduction estimates and the uncertain generation time also give time-varying estimates of the rate of growth.</p>
<p>The default model uses a non-stationary Gaussian process to estimate the time-varying reproduction number. Other options include:</p>
<ul>
<li>A stationary Gaussian process (faster to estimate but currently gives reduced performance for real time estimates).</li>
<li>User specified breakpoints.</li>
<li>A Fixed reproduction number is supported.</li>
<li>As piecewise constant by combining a fixed reproduction number with breakpoints.</li>
<li>As a random walk (by combining a fixed reproduction number with regularly spaced breakpoints (i.e weekly)).</li>
</ul>
<p>The documentation for <a href="https://epiforecasts.io/EpiNow2/reference/estimate_infections.html"><code>estimate_infections</code></a> provides examples of the different options available.</p>
<p>Forecasting is also supported for the time-varying reproduction number, infections and reported cases. The time-varying reproduction number can be forecast forwards in time using an integration with the <a href="https://epiforecasts.io/EpiSoon/"><code>{EpiSoon}</code></a> package, and converted to a case forecast using the renewal equation. Alternatively, the time-varying reproduction number and cases can be forecast using a Gaussian process.</p>
<p>As a standalone tool, non-parametric back-calculation is also supported. This uses a novel formulation based on a smoothed mean delay shift of reported cases combined with a Gaussian process to determine the most likely outbreak trajectory. Again see the documentation for <a href="https://epiforecasts.io/EpiNow2/reference/estimate_infections.html"><code>estimate_infections</code></a> for an example.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Install the stable version of the package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"EpiNow2"</span>)
</pre></div>
<p>Install the stable development version of the package using <a href="https://epiforecasts.io/drat/"><code>{drat}</code></a>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"drat"</span>)
<span class="kw">drat</span>:::<span class="fu">add</span>(<span class="st">"epiforecasts"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"EpiNow2"</span>)
</pre></div>
<p>Install the unstable development version of the package with:</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw">remotes</span>::<span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span>(<span class="st">"epiforecasts/EpiNow2"</span>)
</pre></div>
<p>Windows users will need a working installation of Rtools in order to build the package from source. See <a href="https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#checking-the-c-toolchain">here</a> for a guide to installing Rtools for use with Stan (which is the statistical modeling platform used for the underlying model). For simple deployment/development a prebuilt docker image is also available (see documentation <a href="https://github.com/epiforecasts/EpiNow2/wiki/Docker">here</a>).</p>
</div>
<div id="quick-start" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-start" class="anchor"></a>Quick start</h2>
<p><code>{EpiNow2}</code> is designed to be used with a single function call or to be used in an ad-hoc fashion via individual function calls. In the following section we give an overview of the simple use case. For more on using each function see the <a href="https://epiforecasts.io/EpiNow2/reference/index.html">function documentation</a>. The core functions are: <a href="https://epiforecasts.io/EpiNow2/reference/epinow.html"><code>epinow</code></a>, <a href="https://epiforecasts.io/EpiNow2/reference/epinow.html"><code>regional_epinow</code></a>, <a href="https://epiforecasts.io/EpiNow2/reference/estimate_infections.html"><code>estimate_infections</code></a>, and <a href="https://epiforecasts.io/EpiNow2/reference/forecast_infections.html"><code>forecast_infections</code></a>. <a href="https://epiforecasts.io/EpiNow2/reference/estimate_infections.html"><code>estimate_infections</code></a> can be use on its own to infer the underlying infection case curve from reported cases with Rt optionally returned (on by default). Estimating the underlying infection case curve alone is substantially less computationally demanding than also estimating Rt.</p>
<div id="reporting-delays-incubation-period-and-generation-time" class="section level3">
<h3 class="hasAnchor">
<a href="#reporting-delays-incubation-period-and-generation-time" class="anchor"></a>Reporting delays, incubation period and generation time</h3>
<p>Distributions can either be fitted using package functionality or determined elsewhere and then defined with uncertainty for use in <code>{EpiNow2}</code>. When data is supplied a subsampled bootstrapped lognormal will be fit (to account for uncertainty in the observed data without being biased by changes in incidence). An arbitrary number of delay distributions are supported with the most common use case likely to be a incubation period followed by a reporting delay.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="kw">reporting_delay</span> <span class="op">&lt;-</span> <span class="kw">EpiNow2</span>::<span class="fu"><a href="reference/bootstrapped_dist_fit.html">bootstrapped_dist_fit</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html">rlnorm</a></span>(<span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="fl">6</span>), <span class="fl">1</span>))
<span class="co">## Set max allowed delay to 30 days to truncate computation</span>
<span class="kw">reporting_delay</span><span class="op">$</span><span class="kw">max</span> <span class="op">&lt;-</span> <span class="fl">30</span>

<span class="kw">reporting_delay</span>
<span class="co">#&gt; $mean</span>
<span class="co">#&gt; [1] 1.680835</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mean_sd</span>
<span class="co">#&gt; [1] 0.1177547</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd</span>
<span class="co">#&gt; [1] 1.036805</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd_sd</span>
<span class="co">#&gt; [1] 0.113312</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max</span>
<span class="co">#&gt; [1] 30</span>
</pre></div>
<p>Here we define the incubation period and generation time based on literature estimates for Covid-19 (see <a href="https://github.com/epiforecasts/EpiNow/tree/master/data-raw">here</a> for the code that generates these estimates).</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="kw">generation_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(mean = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">mean</span>,
                        mean_sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">mean_sd</span>,
                         sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">sd</span>,
                         sd_sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">sd_sd</span>,
                         max = <span class="fl">30</span>)

<span class="kw">incubation_period</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(mean = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">mean</span>,
                          mean_sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">mean_sd</span>,
                          sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">sd</span>,
                          sd_sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">sd_sd</span>,
                          max = <span class="fl">30</span>)
</pre></div>
</div>
<div id="epinow" class="section level3">
<h3 class="hasAnchor">
<a href="#epinow" class="anchor"></a><a href="https://epiforecasts.io/EpiNow2/reference/epinow.html">epinow</a>
</h3>
<p>This function represents the core functionality of the package and includes results reporting, plotting and optional saving. It requires a data frame of cases by date of report and the distributions defined above. An additional forecasting module is supported via <code>EpiSoon</code> and companion packages (see documentation for an example).</p>
<p>Load example case data from <code>{EpiNow2}</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="kw">reported_cases</span> <span class="op">&lt;-</span> <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/example_confirmed.html">example_confirmed</a></span>[<span class="fl">1</span><span class="op">:</span><span class="fl">50</span>]

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">reported_cases</span>)
<span class="co">#&gt;          date confirm</span>
<span class="co">#&gt; 1: 2020-02-22      14</span>
<span class="co">#&gt; 2: 2020-02-23      62</span>
<span class="co">#&gt; 3: 2020-02-24      53</span>
<span class="co">#&gt; 4: 2020-02-25      97</span>
<span class="co">#&gt; 5: 2020-02-26      93</span>
<span class="co">#&gt; 6: 2020-02-27      78</span>
</pre></div>
<p>Estimate cases by date of infection, the time-varying reproduction number, the rate of growth and forecast these estimates into the future by 7 days. Summarise the posterior and return a summary table and plots for reporting purposes. If a <code>target_folder</code> is supplied results can be internally saved (with the option to also turn off explicit returning of results). <em>Note that for real use cases more samples and a longer warm up may be needed</em>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="kw">estimates</span> <span class="op">&lt;-</span> <span class="kw">EpiNow2</span>::<span class="fu"><a href="reference/epinow.html">epinow</a></span>(reported_cases = <span class="kw">reported_cases</span>, 
                             generation_time = <span class="kw">generation_time</span>,
                             delays = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">incubation_period</span>, <span class="kw">reporting_delay</span>),
                             horizon = <span class="fl">7</span>, samples = <span class="fl">1000</span>, warmup = <span class="fl">200</span>, 
                             cores = <span class="fl">4</span>, chains = <span class="fl">4</span>, verbose = <span class="fl">TRUE</span>, 
                             adapt_delta = <span class="fl">0.95</span>)
<span class="co">#&gt; DEBUG [2020-08-26 15:22:46] Running for 1000 samples (across 4 chains each with a warm up of 200 iterations each) and 71 time steps of which 7 are a forecast</span>

<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">estimates</span>)
<span class="co">#&gt; [1] "estimates"                "estimated_reported_cases"</span>
<span class="co">#&gt; [3] "summary"                  "plots"</span>
</pre></div>
<p>Both summary measures and posterior samples are returned for all parameters in an easily explored format.</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">estimates</span>
<span class="co">#&gt; $samples</span>
<span class="co">#&gt;                 variable        parameter time       date sample       value</span>
<span class="co">#&gt;      1:       infections       infections    1 2020-02-08      1    2.206644</span>
<span class="co">#&gt;      2:       infections       infections    2 2020-02-09      1    9.431478</span>
<span class="co">#&gt;      3:       infections       infections    3 2020-02-10      1   21.395270</span>
<span class="co">#&gt;      4:       infections       infections    4 2020-02-11      1   30.846361</span>
<span class="co">#&gt;      5:       infections       infections    5 2020-02-12      1   46.237732</span>
<span class="co">#&gt;     ---                                                                     </span>
<span class="co">#&gt; 255067: prior_infections prior_infections   67 2020-04-14      1 2647.130393</span>
<span class="co">#&gt; 255068: prior_infections prior_infections   68 2020-04-15      1 2581.665553</span>
<span class="co">#&gt; 255069: prior_infections prior_infections   69 2020-04-16      1 2517.819692</span>
<span class="co">#&gt; 255070: prior_infections prior_infections   70 2020-04-17      1 2455.552770</span>
<span class="co">#&gt; 255071: prior_infections prior_infections   71 2020-04-18      1 2394.825740</span>
<span class="co">#&gt;         strat     type</span>
<span class="co">#&gt;      1:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;      2:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;      3:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;      4:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;      5:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;     ---               </span>
<span class="co">#&gt; 255067:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; 255068:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; 255069:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; 255070:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; 255071:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summarised</span>
<span class="co">#&gt;            date       variable strat     type     bottom         top</span>
<span class="co">#&gt;   1: 2020-02-22              R  &lt;NA&gt; estimate   0.906830    1.568452</span>
<span class="co">#&gt;   2: 2020-02-23              R  &lt;NA&gt; estimate   1.017340    1.560870</span>
<span class="co">#&gt;   3: 2020-02-24              R  &lt;NA&gt; estimate   1.101175    1.552501</span>
<span class="co">#&gt;   4: 2020-02-25              R  &lt;NA&gt; estimate   1.196505    1.554018</span>
<span class="co">#&gt;   5: 2020-02-26              R  &lt;NA&gt; estimate   1.316793    1.607314</span>
<span class="co">#&gt;  ---                                                                </span>
<span class="co">#&gt; 322: 2020-04-14 reported_cases  &lt;NA&gt; forecast 695.000000 6529.000000</span>
<span class="co">#&gt; 323: 2020-04-15 reported_cases  &lt;NA&gt; forecast 419.000000 5621.000000</span>
<span class="co">#&gt; 324: 2020-04-16 reported_cases  &lt;NA&gt; forecast 364.000000 6466.000000</span>
<span class="co">#&gt; 325: 2020-04-17 reported_cases  &lt;NA&gt; forecast 397.000000 8587.000000</span>
<span class="co">#&gt; 326: 2020-04-18 reported_cases  &lt;NA&gt; forecast 289.000000 7005.000000</span>
<span class="co">#&gt;            lower       upper      median        mean           sd</span>
<span class="co">#&gt;   1:    1.044737    1.309596    1.223438    1.222365 2.022448e-01</span>
<span class="co">#&gt;   2:    1.139059    1.368749    1.266639    1.270122 1.696516e-01</span>
<span class="co">#&gt;   3:    1.230104    1.417863    1.323299    1.325053 1.385959e-01</span>
<span class="co">#&gt;   4:    1.312648    1.467412    1.381972    1.385947 1.109667e-01</span>
<span class="co">#&gt;   5:    1.402101    1.527912    1.448480    1.451127 9.032870e-02</span>
<span class="co">#&gt;  ---                                                             </span>
<span class="co">#&gt; 322: 1254.000000 3183.000000 2772.000000 3386.243000 2.378292e+03</span>
<span class="co">#&gt; 323:  903.000000 2562.000000 2342.000000 3033.583000 2.574506e+03</span>
<span class="co">#&gt; 324:  924.000000 2942.000000 2685.500000 3657.875000 4.357484e+03</span>
<span class="co">#&gt; 325: 1191.000000 3496.000000 3096.000000 5197.417000 1.469759e+04</span>
<span class="co">#&gt; 326:  854.000000 2691.000000 2355.000000 5417.498000 3.578082e+04</span>
</pre></div>
<p>Reported cases are returned separately in order to ease reporting of forecasts and model evaluation.</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">estimated_reported_cases</span>
<span class="co">#&gt; $samples</span>
<span class="co">#&gt;              date sample cases  type</span>
<span class="co">#&gt;     1: 2020-02-22      1    93 gp_rt</span>
<span class="co">#&gt;     2: 2020-02-23      1   170 gp_rt</span>
<span class="co">#&gt;     3: 2020-02-24      1   119 gp_rt</span>
<span class="co">#&gt;     4: 2020-02-25      1   200 gp_rt</span>
<span class="co">#&gt;     5: 2020-02-26      1    78 gp_rt</span>
<span class="co">#&gt;    ---                              </span>
<span class="co">#&gt; 56996: 2020-04-14   1000  1464 gp_rt</span>
<span class="co">#&gt; 56997: 2020-04-15   1000  1581 gp_rt</span>
<span class="co">#&gt; 56998: 2020-04-16   1000  1439 gp_rt</span>
<span class="co">#&gt; 56999: 2020-04-17   1000  1499 gp_rt</span>
<span class="co">#&gt; 57000: 2020-04-18   1000  2037 gp_rt</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summarised</span>
<span class="co">#&gt;           date  type bottom   top lower upper median     mean          sd</span>
<span class="co">#&gt;  1: 2020-02-22 gp_rt     31   175    48   108   96.5  104.307    50.51481</span>
<span class="co">#&gt;  2: 2020-02-23 gp_rt     43   243    83   163  139.5  148.957    69.30538</span>
<span class="co">#&gt;  3: 2020-02-24 gp_rt     46   269    96   187  159.0  168.320    74.53631</span>
<span class="co">#&gt;  4: 2020-02-25 gp_rt     56   303    91   186  161.0  175.871    84.52076</span>
<span class="co">#&gt;  5: 2020-02-26 gp_rt     60   297    85   175  156.5  169.978    76.10236</span>
<span class="co">#&gt;  6: 2020-02-27 gp_rt     58   397   123   247  215.0  237.670   119.01744</span>
<span class="co">#&gt;  7: 2020-02-28 gp_rt     74   524   161   332  287.5  320.237   158.99453</span>
<span class="co">#&gt;  8: 2020-02-29 gp_rt     91   504   155   313  272.0  298.097   139.30512</span>
<span class="co">#&gt;  9: 2020-03-01 gp_rt    112   652   186   399  350.0  381.556   183.33621</span>
<span class="co">#&gt; 10: 2020-03-02 gp_rt    102   697   235   473  398.0  426.200   210.03135</span>
<span class="co">#&gt; 11: 2020-03-03 gp_rt    119   745   244   476  393.0  431.998   219.71267</span>
<span class="co">#&gt; 12: 2020-03-04 gp_rt     98   708   214   447  389.0  428.876   212.76694</span>
<span class="co">#&gt; 13: 2020-03-05 gp_rt    190  1019   302   633  567.0  615.846   294.66908</span>
<span class="co">#&gt; 14: 2020-03-06 gp_rt    259  1528   403   885  784.5  879.237   444.90818</span>
<span class="co">#&gt; 15: 2020-03-07 gp_rt    261  1474   404   846  765.0  846.184   425.04547</span>
<span class="co">#&gt; 16: 2020-03-08 gp_rt    311  1963   633  1268 1070.5 1167.124   609.49882</span>
<span class="co">#&gt; 17: 2020-03-09 gp_rt    352  2301   753  1511 1252.5 1354.985   656.34476</span>
<span class="co">#&gt; 18: 2020-03-10 gp_rt    406  2451   796  1609 1322.5 1427.365   694.09473</span>
<span class="co">#&gt; 19: 2020-03-11 gp_rt    300  2380   726  1502 1323.0 1463.005   759.85016</span>
<span class="co">#&gt; 20: 2020-03-12 gp_rt    565  3445  1198  2362 1911.0 2086.378  1040.60247</span>
<span class="co">#&gt; 21: 2020-03-13 gp_rt    924  5119  1399  2979 2636.0 2919.580  1477.38699</span>
<span class="co">#&gt; 22: 2020-03-14 gp_rt    806  4664  1450  2936 2463.0 2705.797  1303.82767</span>
<span class="co">#&gt; 23: 2020-03-15 gp_rt    831  5917  2178  4188 3215.5 3537.972  1715.04663</span>
<span class="co">#&gt; 24: 2020-03-16 gp_rt    897  6518  2137  4256 3554.0 3883.479  1899.95173</span>
<span class="co">#&gt; 25: 2020-03-17 gp_rt   1176  6454  1931  3889 3351.5 3703.498  1747.03212</span>
<span class="co">#&gt; 26: 2020-03-18 gp_rt   1209  6201  1929  3789 3153.0 3491.560  1735.67271</span>
<span class="co">#&gt; 27: 2020-03-19 gp_rt   1262  7499  2709  5265 4191.0 4512.308  2115.62561</span>
<span class="co">#&gt; 28: 2020-03-20 gp_rt   1370  9582  3310  6452 5533.0 5950.403  2785.43400</span>
<span class="co">#&gt; 29: 2020-03-21 gp_rt   1392  8500  2949  5727 4694.5 5008.814  2342.54236</span>
<span class="co">#&gt; 30: 2020-03-22 gp_rt   1689 10023  3075  6316 5376.5 5891.644  2845.84631</span>
<span class="co">#&gt; 31: 2020-03-23 gp_rt   1820 10445  3198  6456 5507.0 6033.768  2923.72504</span>
<span class="co">#&gt; 32: 2020-03-24 gp_rt   1773  8987  3287  6124 5014.5 5363.948  2520.06870</span>
<span class="co">#&gt; 33: 2020-03-25 gp_rt   1332  7680  2535  4977 4247.0 4606.321  2182.78039</span>
<span class="co">#&gt; 34: 2020-03-26 gp_rt   1830  9924  3106  6214 5407.0 5803.149  2741.00916</span>
<span class="co">#&gt; 35: 2020-03-27 gp_rt   2308 11236  3566  7045 6161.0 6619.664  3299.92875</span>
<span class="co">#&gt; 36: 2020-03-28 gp_rt   1623  9285  3015  5923 5047.0 5427.988  2553.89665</span>
<span class="co">#&gt; 37: 2020-03-29 gp_rt   1677 10351  3857  7317 5761.5 6183.392  3004.75043</span>
<span class="co">#&gt; 38: 2020-03-30 gp_rt   1426  9718  3435  6368 5267.0 5739.116  2743.96398</span>
<span class="co">#&gt; 39: 2020-03-31 gp_rt   1328  8490  2644  5417 4719.5 5104.631  2417.34093</span>
<span class="co">#&gt; 40: 2020-04-01 gp_rt   1069  6956  2727  5083 4007.0 4277.459  1925.56661</span>
<span class="co">#&gt; 41: 2020-04-02 gp_rt   1260  8153  2611  5088 4376.0 4823.408  2350.00527</span>
<span class="co">#&gt; 42: 2020-04-03 gp_rt   1493 10095  2620  5668 5183.0 5747.842  3014.38984</span>
<span class="co">#&gt; 43: 2020-04-04 gp_rt   1205  7391  2393  4770 4106.5 4460.568  2107.54760</span>
<span class="co">#&gt; 44: 2020-04-05 gp_rt   1366  8411  2658  5458 4610.0 4964.977  2407.32976</span>
<span class="co">#&gt; 45: 2020-04-06 gp_rt   1229  7727  2552  4974 4203.0 4636.208  2238.66048</span>
<span class="co">#&gt; 46: 2020-04-07 gp_rt   1153  6839  2220  4397 3573.5 3992.999  2067.80000</span>
<span class="co">#&gt; 47: 2020-04-08 gp_rt   1208  5882  1661  3414 3025.0 3343.165  1639.06683</span>
<span class="co">#&gt; 48: 2020-04-09 gp_rt    789  6664  2286  4486 3515.5 3924.625  2061.85895</span>
<span class="co">#&gt; 49: 2020-04-10 gp_rt   1279  7899  2743  5200 4164.5 4597.328  2373.24618</span>
<span class="co">#&gt; 50: 2020-04-11 gp_rt    761  5915  2123  4139 3261.5 3613.558  1814.91540</span>
<span class="co">#&gt; 51: 2020-04-12 gp_rt    896  7087  2086  4609 3600.5 4110.504  2342.33555</span>
<span class="co">#&gt; 52: 2020-04-13 gp_rt    825  7385  1686  3904 3265.5 3911.608  2376.82439</span>
<span class="co">#&gt; 53: 2020-04-14 gp_rt    695  6529  1254  3183 2772.0 3386.243  2378.29173</span>
<span class="co">#&gt; 54: 2020-04-15 gp_rt    419  5621   903  2562 2342.0 3033.583  2574.50603</span>
<span class="co">#&gt; 55: 2020-04-16 gp_rt    364  6466   924  2942 2685.5 3657.875  4357.48423</span>
<span class="co">#&gt; 56: 2020-04-17 gp_rt    397  8587  1191  3496 3096.0 5197.417 14697.58863</span>
<span class="co">#&gt; 57: 2020-04-18 gp_rt    289  7005   854  2691 2355.0 5417.498 35780.82391</span>
<span class="co">#&gt;           date  type bottom   top lower upper median     mean          sd</span>
</pre></div>
<p>A summary table is returned for rapidly understanding the results and for reporting purposes.</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">summary</span>
<span class="co">#&gt;                                  measure              estimate</span>
<span class="co">#&gt; 1: New confirmed cases by infection date     2180 (85 -- 7609)</span>
<span class="co">#&gt; 2:        Expected change in daily cases                Unsure</span>
<span class="co">#&gt; 3:            Effective reproduction no.    0.8 (0.31 -- 1.49)</span>
<span class="co">#&gt; 4:                        Rate of growth -0.06 (-0.22 -- 0.12)</span>
<span class="co">#&gt; 5:          Doubling/halving time (days)   -12.1 (5.6 -- -3.2)</span>
<span class="co">#&gt;     numeric_estimate</span>
<span class="co">#&gt; 1: &lt;data.table[1x5]&gt;</span>
<span class="co">#&gt; 2:              0.69</span>
<span class="co">#&gt; 3: &lt;data.table[1x5]&gt;</span>
<span class="co">#&gt; 4: &lt;data.table[1x5]&gt;</span>
<span class="co">#&gt; 5: &lt;data.table[1x3]&gt;</span>
</pre></div>
<p>A range of plots are returned (with the single summary plot shown below).</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">plots</span><span class="op">$</span><span class="kw">summary</span>
</pre></div>
<p><img src="reference/figures/unnamed-chunk-12-1.png"><!-- --></p>
</div>
<div id="regional-epinow" class="section level3">
<h3 class="hasAnchor">
<a href="#regional-epinow" class="anchor"></a><a href="https://epiforecasts.io/EpiNow2/reference/regional_epinow.html">Regional epinow</a>
</h3>
<p>This function runs the the <code>epinow</code> function across multiple regions in an efficient manner.</p>
<p>Define cases in multiple regions delineated by the region variable.</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="kw">reported_cases</span> <span class="op">&lt;-</span> <span class="kw">data.table</span>::<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbindlist</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
   <span class="kw">data.table</span>::<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html">copy</a></span>(<span class="kw">reported_cases</span>)[, <span class="kw">region</span> <span class="op">:=</span> <span class="st">"testland"</span>],
   <span class="kw">reported_cases</span>[, <span class="kw">region</span> <span class="op">:=</span> <span class="st">"realland"</span>]))

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">reported_cases</span>)
<span class="co">#&gt;          date confirm   region</span>
<span class="co">#&gt; 1: 2020-02-22      14 testland</span>
<span class="co">#&gt; 2: 2020-02-23      62 testland</span>
<span class="co">#&gt; 3: 2020-02-24      53 testland</span>
<span class="co">#&gt; 4: 2020-02-25      97 testland</span>
<span class="co">#&gt; 5: 2020-02-26      93 testland</span>
<span class="co">#&gt; 6: 2020-02-27      78 testland</span>
</pre></div>
<p>Run the pipeline on each region in turn. The commented code (requires the <code>{future}</code> package) can be used to run regions in parallel (when in most scenarios <code>cores</code> should be set to 1).</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="co">## future::plan("multisession")</span>
<span class="kw">estimates</span> <span class="op">&lt;-</span> <span class="kw">EpiNow2</span>::<span class="fu"><a href="reference/regional_epinow.html">regional_epinow</a></span>(reported_cases = <span class="kw">reported_cases</span>, 
                                      generation_time = <span class="kw">generation_time</span>,
                                      delays = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">incubation_period</span>, <span class="kw">reporting_delay</span>),
                                      horizon = <span class="fl">7</span>, samples = <span class="fl">1000</span>, warmup = <span class="fl">200</span>,
                                      cores = <span class="fl">4</span>, chains = <span class="fl">4</span>, adapt_delta = <span class="fl">0.95</span>,
                                      verbose = <span class="fl">TRUE</span>)
<span class="co">#&gt; INFO [2020-08-26 15:25:06] Reporting estimates using data up to: 2020-04-11</span>
<span class="co">#&gt; INFO [2020-08-26 15:25:06] Producing estimates for: testland, realland</span>
<span class="co">#&gt; INFO [2020-08-26 15:25:06] Initialising estimates for: testland</span>
<span class="co">#&gt; DEBUG [2020-08-26 15:25:06] Running for 1000 samples (across 4 chains each with a warm up of 200 iterations each) and 71 time steps of which 7 are a forecast</span>
<span class="co">#&gt; INFO [2020-08-26 15:27:15] Completed estimates for: testland</span>
<span class="co">#&gt; INFO [2020-08-26 15:27:15] Initialising estimates for: realland</span>
<span class="co">#&gt; DEBUG [2020-08-26 15:27:15] Running for 1000 samples (across 4 chains each with a warm up of 200 iterations each) and 71 time steps of which 7 are a forecast</span>
<span class="co">#&gt; INFO [2020-08-26 15:29:58] Completed estimates for: realland</span>
</pre></div>
<p>Results from each region are stored in a <code>regional</code> list with across region summary measures and plots stored in a <code>summary</code> list. All results can be set to be internally saved by setting the <code>target_folder</code> and <code>summary_dir</code> arguments.</p>
<p>Summary measures that are returned include a table formatted for reporting (along with raw results for further processing).</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">summary</span><span class="op">$</span><span class="kw">summarised_results</span><span class="op">$</span><span class="kw">table</span>
<span class="co">#&gt;      Region New confirmed cases by infection date</span>
<span class="co">#&gt; 1: realland                    2236 (125 -- 7642)</span>
<span class="co">#&gt; 2: testland                     2066 (37 -- 7156)</span>
<span class="co">#&gt;    Expected change in daily cases Effective reproduction no.</span>
<span class="co">#&gt; 1:                         Unsure         0.81 (0.23 -- 1.4)</span>
<span class="co">#&gt; 2:                         Unsure        0.78 (0.18 -- 1.39)</span>
<span class="co">#&gt;           Rate of growth Doubling/halving time (days)</span>
<span class="co">#&gt; 1:  -0.05 (-0.2 -- 0.14)            -13.2 (5 -- -3.4)</span>
<span class="co">#&gt; 2: -0.06 (-0.25 -- 0.12)          -11.2 (5.8 -- -2.8)</span>
</pre></div>
<p>A range of plots are again returned (with the single summary plot shown below).</p>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">summary</span><span class="op">$</span><span class="kw">summary_plot</span>
</pre></div>
<p><img src="reference/figures/unnamed-chunk-16-1.png"><!-- --></p>
</div>
<div id="reporting-templates" class="section level3">
<h3 class="hasAnchor">
<a href="#reporting-templates" class="anchor"></a>Reporting templates</h3>
<p>Rmarkdown templates are provided in the package (<code>templates</code>) for semi-automated reporting of estimates. These are currently undocumented but an example integration can be seen <a href="https://github.com/epiforecasts/covid/blob/master/_posts/national/united-kingdom/united-kingdom.Rmd">here</a>. If using these templates to report your results please highlight our <a href="https://doi.org/10.12688/wellcomeopenres.16006.1">limitations</a> as these are key to understanding the results from <code>{EpiNow2}</code> .</p>
</div>
</div>
<div id="contributing" class="section level2">
<h2 class="hasAnchor">
<a href="#contributing" class="anchor"></a>Contributing</h2>
<p>File an issue <a href="https://github.com/epiforecasts/EpiNow2/issues">here</a> if you have identified an issue with the package. Please note that due to operational constraints priority will be given to users informing government policy or offering methodological insights. We welcome all contributions, in particular those that improve the approach or the robustness of the code base.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing EpiNow2</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Sam Abbott <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-8057-8037" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Joel Hellewell <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-2683-0849" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Robin Thompson <br><small class="roles"> Author </small>  </li>
<li>Katelyn Gostic <br><small class="roles"> Author </small>  </li>
<li>Katharine Sherratt <br><small class="roles"> Author </small>  </li>
<li>Sophie Meakin <br><small class="roles"> Author </small>  </li>
<li>James Munday <br><small class="roles"> Author </small>  </li>
<li>Nikos Bosse <br><small class="roles"> Author </small>  </li>
<li>Joe Hickson <br><small class="roles"> Author </small>  </li>
<li>EpiForecasts <br><small class="roles"> Author </small>  </li>
<li>Sebastian Funk <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/epiforecasts/EpiNow2/actions"><img src="https://github.com/epiforecasts/EpiNow2/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://codecov.io/gh/epiforecasts/EpiNow2?branch=master"><img src="https://codecov.io/gh/epiforecasts/EpiNow2/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://zenodo.org/badge/latestdoi/272995211"><img src="https://zenodo.org/badge/272995211.svg" alt="DOI"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Sam Abbott, Joel Hellewell, Robin Thompson, Katelyn Gostic, Katharine Sherratt, Sophie Meakin, James Munday, Nikos Bosse, Joe Hickson, EpiForecasts, Sebastian Funk.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
