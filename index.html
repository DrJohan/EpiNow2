<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimate Real-Time Case Counts and Time-Varying Epidemiological Parameters  â€¢ EpiNow2</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Estimate Real-Time Case Counts and Time-Varying Epidemiological Parameters ">
<meta property="og:description" content="Estimates the time-varying reproduction number, rate of spread,
             and doubling time using a range of open-source tools, a novel methodology,
             and current best practices. It aims to help users avoid some of the limitations 
             of naive implementations in a framework that is informed by community feedback 
             and is under active development.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">EpiNow2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
<li>
  <a href="reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/epiforecasts/EpiNow2">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="epinow2-estimate-real-time-case-counts-and-time-varying-epidemiological-parameters" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#epinow2-estimate-real-time-case-counts-and-time-varying-epidemiological-parameters" class="anchor"></a>EpiNow2: Estimate real-time case counts and time-varying epidemiological parameters</h1></div>

<p>This package estimates the time-varying reproduction number, rate of spread, and doubling time using a range of open-source tools, a novel methodology, and current best practices. It aims to help users avoid some of the limitations of naive implementations in a framework that is informed by community feedback and is under active development. It estimates the time-varying reproduction number on cases by date of infection (using a similar approach to that implemented in the <a href="https://github.com/annecori/EpiEstim"><code>{EpiEstim}</code></a>). Imputed infections are then mapped to observed data (for example cases by date of report) via a series of uncertain delay distributions (in the examples in the package documentation these are an incubation period and a reporting delay) and a reporting model that can include weekly periodicity. The default model uses a non-stationary Gaussian process to estimate the time-varying reproduction number but optionally a stationary Gaussian process may be used (faster to estimate but reduced performance for real time estimates) and arbitrary breakpoints can be defined. A fixed reproduction number is also supported. When combined with user defined breakpoints this gives the option of modelling the time-varying reproduction number as piecewise linear. The documentation for <a href="https://epiforecasts.io/EpiNow2/reference/estimate_infections.html"><code>estimate_infections</code></a> provides examples of the different options available. Propagating uncertainty from all inputs into the final parameter estimates (helping to mitigate spurious findings) is handled internally. Time-varying estimates of the rate of growth are derived from the time-varying reproduction estimates and the uncertain generation time. Optionally, the time-varying reproduction number can be forecast forwards in time using an integration with the <a href="https://epiforecasts.io/EpiSoon"><code>{EpiSoon}</code></a> package and converted to a case forecast using the renewal equation. Alternatively, the time-varying reproduction number and cases can be forecast using a Gaussian process. As a standalone tool non-parametric back-calculation is also supported using a novel formulation based on a smoothed mean delay shift of reported cases combined with a Gaussian process to determine the most likely outbreak trajectory.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Install the stable version of the package using <a href="https://epiforecasts.io/drat/"><code>{drat}</code></a>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"drat"</span>)
<span class="kw">drat</span>:::<span class="fu">add</span>(<span class="st">"epiforecasts"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"EpiNow2"</span>)
</pre></div>
<p>Install the development version of the package with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="kw">remotes</span>::<span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span>(<span class="st">"epiforecasts/EpiNow2"</span>)
</pre></div>
<p>Windows users will need a working installation of Rtools in order to build the package from source. See <a href="https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#checking-the-c-toolchain">here</a> for a guide to installing Rtools for use with Stan (which is the statistical modeling platform used for the underlying model). For simple deployment/development a prebuilt docker image is also available (see documentation <a href="https://github.com/epiforecasts/EpiNow2/wiki/Docker">here</a>).</p>
</div>
<div id="quick-start" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-start" class="anchor"></a>Quick start</h2>
<p><code>{EpiNow}</code> is designed to be used with a single function call or to be used in an ad-hoc fashion via individual function calls. In the following section we give an overview of the simple use case. For more on using each function see the <a href="https://epiforecasts.io/EpiNow2/reference/index.html">function documentation</a>. The core functions are: <a href="https://epiforecasts.io/EpiNow2/reference/epinow.html"><code>epinow</code></a>, <a href="https://epiforecasts.io/EpiNow2/reference/epinow.html"><code>regional_epinow</code></a>, <a href="https://epiforecasts.io/EpiNow2/reference/estimate_infections.html"><code>estimate_infections</code></a>, and <a href="https://epiforecasts.io/EpiNow2/reference/forecast_infections.html"><code>forecast_infections</code></a>. <a href="https://epiforecasts.io/EpiNow2/reference/estimate_infections.html"><code>estimate_infections</code></a> can be use on its own to infer the underlying infection case curve from reported cases with Rt optionally returned (on by default). Estimating the underlying infection case curve alone is substantially less computationally demanding than also estimating Rt.</p>
<div id="reporting-delays-incubation-period-and-generation-time" class="section level3">
<h3 class="hasAnchor">
<a href="#reporting-delays-incubation-period-and-generation-time" class="anchor"></a>Reporting delays, incubation period and generation time</h3>
<p>Distributions can either be fitted using package functionality or determined elsewhere and then defined with uncertainty for use in <code>{EpiNow2}</code>. When data is supplied a subsampled bootstrapped lognormal will be fit (to account for uncertainty in the observed data without being biased by changes in incidence). An arbitrary number of delay distributions are supported with the most common use case likely to be a incubation period followed by a reporting delay.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw">reporting_delay</span> <span class="op">&lt;-</span> <span class="kw">EpiNow2</span>::<span class="fu"><a href="reference/bootstrapped_dist_fit.html">bootstrapped_dist_fit</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html">rlnorm</a></span>(<span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="fl">6</span>), <span class="fl">1</span>))
<span class="co">## Set max allowed delay to 30 days to truncate computation</span>
<span class="kw">reporting_delay</span><span class="op">$</span><span class="kw">max</span> <span class="op">&lt;-</span> <span class="fl">30</span>

<span class="kw">reporting_delay</span>
<span class="co">#&gt; $mean</span>
<span class="co">#&gt; [1] 1.885566</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mean_sd</span>
<span class="co">#&gt; [1] 0.1940598</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd</span>
<span class="co">#&gt; [1] 1.083473</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd_sd</span>
<span class="co">#&gt; [1] 0.1075116</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max</span>
<span class="co">#&gt; [1] 30</span>
</pre></div>
<p>Here we define the incubation period and generation time based on literature estimates for Covid-19 (see <a href="https://github.com/epiforecasts/EpiNow/tree/master/data-raw">here</a> for the code that generates these estimates).</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="kw">generation_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(mean = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">mean</span>,
                        mean_sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">mean_sd</span>,
                         sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">sd</span>,
                         sd_sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">sd_sd</span>,
                         max = <span class="fl">30</span>)

<span class="kw">incubation_period</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(mean = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">mean</span>,
                          mean_sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">mean_sd</span>,
                          sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">sd</span>,
                          sd_sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">sd_sd</span>,
                          max = <span class="fl">30</span>)
</pre></div>
</div>
<div id="epinow" class="section level3">
<h3 class="hasAnchor">
<a href="#epinow" class="anchor"></a><a href="https://epiforecasts.io/EpiNow2/reference/epinow.html">epinow</a>
</h3>
<p>This function represents the core functionality of the package and includes results reporting, plotting and optional saving. It requires a data frame of cases by date of report and the distributions defined above. An additional forecasting module is supported via <code>EpiSoon</code> and companion packages (see documentation for an example).</p>
<p>Load example case data from <code>{EpiNow2}</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="kw">reported_cases</span> <span class="op">&lt;-</span> <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/example_confirmed.html">example_confirmed</a></span>[<span class="fl">1</span><span class="op">:</span><span class="fl">50</span>]

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">reported_cases</span>)
<span class="co">#&gt;          date confirm</span>
<span class="co">#&gt; 1: 2020-02-22      14</span>
<span class="co">#&gt; 2: 2020-02-23      62</span>
<span class="co">#&gt; 3: 2020-02-24      53</span>
<span class="co">#&gt; 4: 2020-02-25      97</span>
<span class="co">#&gt; 5: 2020-02-26      93</span>
<span class="co">#&gt; 6: 2020-02-27      78</span>
</pre></div>
<p>Estimate cases by date of infection, the time-varying reproduction number, the rate of growth and forecast these estimates into the future by 7 days. Summarise the posterior and return a summary table and plots for reporting purposes. If a <code>target_folder</code> is supplied results can be internally saved (with the option to also turn off explicit returning of results). <em>Note that for real use cases more samples and a longer warm up may be needed</em>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="kw">estimates</span> <span class="op">&lt;-</span> <span class="kw">EpiNow2</span>::<span class="fu"><a href="reference/epinow.html">epinow</a></span>(reported_cases = <span class="kw">reported_cases</span>, 
                             generation_time = <span class="kw">generation_time</span>,
                             delays = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">incubation_period</span>, <span class="kw">reporting_delay</span>),
                             horizon = <span class="fl">7</span>, samples = <span class="fl">1000</span>, warmup = <span class="fl">200</span>, 
                             cores = <span class="fl">4</span>, chains = <span class="fl">4</span>, verbose = <span class="fl">TRUE</span>, 
                             adapt_delta = <span class="fl">0.95</span>)

<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">estimates</span>)
<span class="co">#&gt; [1] "estimates"                "estimated_reported_cases"</span>
<span class="co">#&gt; [3] "summary"                  "plots"</span>
</pre></div>
<p>Both summary measures and posterior samples are returned for all parameters in an easily explored format.</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">estimates</span>
<span class="co">#&gt; $samples</span>
<span class="co">#&gt;                 variable          parameter time       date sample    value</span>
<span class="co">#&gt;      1:       infections imputed_infections    1 2020-02-05      1    2.000</span>
<span class="co">#&gt;      2:       infections imputed_infections    2 2020-02-06      1   13.000</span>
<span class="co">#&gt;      3:       infections imputed_infections    3 2020-02-07      1   24.000</span>
<span class="co">#&gt;      4:       infections imputed_infections    4 2020-02-08      1   34.000</span>
<span class="co">#&gt;      5:       infections imputed_infections    5 2020-02-09      1   42.000</span>
<span class="co">#&gt;     ---                                                                    </span>
<span class="co">#&gt; 258070: prior_infections   prior_infections   70 2020-04-14      1 2455.553</span>
<span class="co">#&gt; 258071: prior_infections   prior_infections   71 2020-04-15      1 2394.826</span>
<span class="co">#&gt; 258072: prior_infections   prior_infections   72 2020-04-16      1 2335.601</span>
<span class="co">#&gt; 258073: prior_infections   prior_infections   73 2020-04-17      1 2277.840</span>
<span class="co">#&gt; 258074: prior_infections   prior_infections   74 2020-04-18      1 2221.508</span>
<span class="co">#&gt;         strat     type</span>
<span class="co">#&gt;      1:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;      2:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;      3:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;      4:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;      5:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;     ---               </span>
<span class="co">#&gt; 258070:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; 258071:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; 258072:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; 258073:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; 258074:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summarised</span>
<span class="co">#&gt;            date       variable strat     type      bottom         top</span>
<span class="co">#&gt;   1: 2020-02-22              R  &lt;NA&gt; estimate   0.5467694    1.286161</span>
<span class="co">#&gt;   2: 2020-02-23              R  &lt;NA&gt; estimate   0.6521650    1.304901</span>
<span class="co">#&gt;   3: 2020-02-24              R  &lt;NA&gt; estimate   0.7546103    1.313469</span>
<span class="co">#&gt;   4: 2020-02-25              R  &lt;NA&gt; estimate   0.8838421    1.342418</span>
<span class="co">#&gt;   5: 2020-02-26              R  &lt;NA&gt; estimate   1.0219307    1.393675</span>
<span class="co">#&gt;  ---                                                                 </span>
<span class="co">#&gt; 328: 2020-04-14 reported_cases  &lt;NA&gt; forecast 388.0000000 7021.000000</span>
<span class="co">#&gt; 329: 2020-04-15 reported_cases  &lt;NA&gt; forecast 264.0000000 5990.000000</span>
<span class="co">#&gt; 330: 2020-04-16 reported_cases  &lt;NA&gt; forecast 242.0000000 7410.000000</span>
<span class="co">#&gt; 331: 2020-04-17 reported_cases  &lt;NA&gt; forecast 154.0000000 9266.000000</span>
<span class="co">#&gt; 332: 2020-04-18 reported_cases  &lt;NA&gt; forecast 242.0000000 8771.000000</span>
<span class="co">#&gt;            lower       upper       median         mean           sd</span>
<span class="co">#&gt;   1:   0.7034014    1.029771    0.9072823 9.140003e-01 2.322419e-01</span>
<span class="co">#&gt;   2:   0.8171089    1.099669    0.9613683 9.689321e-01 2.029464e-01</span>
<span class="co">#&gt;   3:   0.8818499    1.119294    1.0305041 1.034429e+00 1.728571e-01</span>
<span class="co">#&gt;   4:   1.0193432    1.214194    1.1082904 1.110039e+00 1.429186e-01</span>
<span class="co">#&gt;   5:   1.1142117    1.268379    1.1949682 1.194685e+00 1.159475e-01</span>
<span class="co">#&gt;  ---                                                               </span>
<span class="co">#&gt; 328: 848.0000000 3013.000000 2674.0000000 3.656382e+03 3.975340e+03</span>
<span class="co">#&gt; 329: 445.0000000 2233.000000 2115.0000000 3.279910e+03 5.432876e+03</span>
<span class="co">#&gt; 330: 825.0000000 2899.000000 2516.0000000 4.699695e+03 1.434458e+04</span>
<span class="co">#&gt; 331: 751.0000000 3285.000000 2998.5000000 1.150776e+04 1.116779e+05</span>
<span class="co">#&gt; 332: 516.0000000 2477.000000 2345.5000000 3.256363e+04 5.940402e+05</span>
</pre></div>
<p>Reported cases are returned separately in order to ease reporting of forecasts and model evaluation.</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">estimated_reported_cases</span>
<span class="co">#&gt; $samples</span>
<span class="co">#&gt;              date sample cases  type</span>
<span class="co">#&gt;     1: 2020-02-22      1   150 gp_rt</span>
<span class="co">#&gt;     2: 2020-02-23      1   353 gp_rt</span>
<span class="co">#&gt;     3: 2020-02-24      1   292 gp_rt</span>
<span class="co">#&gt;     4: 2020-02-25      1   234 gp_rt</span>
<span class="co">#&gt;     5: 2020-02-26      1   519 gp_rt</span>
<span class="co">#&gt;    ---                              </span>
<span class="co">#&gt; 56996: 2020-04-14   1000  3003 gp_rt</span>
<span class="co">#&gt; 56997: 2020-04-15   1000  1035 gp_rt</span>
<span class="co">#&gt; 56998: 2020-04-16   1000  3866 gp_rt</span>
<span class="co">#&gt; 56999: 2020-04-17   1000  1485 gp_rt</span>
<span class="co">#&gt; 57000: 2020-04-18   1000   423 gp_rt</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summarised</span>
<span class="co">#&gt;           date  type bottom   top lower upper median      mean          sd</span>
<span class="co">#&gt;  1: 2020-02-22 gp_rt     24   337    75   193  167.5   188.552    111.1443</span>
<span class="co">#&gt;  2: 2020-02-23 gp_rt     36   451   113   274  225.0   251.523    150.2807</span>
<span class="co">#&gt;  3: 2020-02-24 gp_rt     42   534   117   294  250.0   285.836    173.8437</span>
<span class="co">#&gt;  4: 2020-02-25 gp_rt     43   508    88   282  253.0   282.980    172.1243</span>
<span class="co">#&gt;  5: 2020-02-26 gp_rt     36   446   126   291  245.0   268.703    154.0110</span>
<span class="co">#&gt;  6: 2020-02-27 gp_rt     47   677   159   385  315.5   362.559    223.9880</span>
<span class="co">#&gt;  7: 2020-02-28 gp_rt     93   855   174   467  401.0   447.477    269.1780</span>
<span class="co">#&gt;  8: 2020-02-29 gp_rt     45   692   153   395  337.5   388.398    240.1563</span>
<span class="co">#&gt;  9: 2020-03-01 gp_rt     82   862   173   471  409.0   479.091    290.8755</span>
<span class="co">#&gt; 10: 2020-03-02 gp_rt     40   965   165   507  450.5   525.871    334.8466</span>
<span class="co">#&gt; 11: 2020-03-03 gp_rt     72   898   194   498  426.5   495.400    316.0904</span>
<span class="co">#&gt; 12: 2020-03-04 gp_rt     64   893   214   516  421.0   487.541    313.5501</span>
<span class="co">#&gt; 13: 2020-03-05 gp_rt     61  1187   252   669  562.5   650.892    414.0864</span>
<span class="co">#&gt; 14: 2020-03-06 gp_rt    181  1675   421   997  828.0   925.804    556.0546</span>
<span class="co">#&gt; 15: 2020-03-07 gp_rt    169  1630   320   863  740.0   840.909    510.3828</span>
<span class="co">#&gt; 16: 2020-03-08 gp_rt    205  2143   409  1118  966.0  1144.323    778.3898</span>
<span class="co">#&gt; 17: 2020-03-09 gp_rt    191  2525   527  1352 1151.0  1370.412    873.2386</span>
<span class="co">#&gt; 18: 2020-03-10 gp_rt    217  2583   449  1318 1177.0  1380.036    890.2474</span>
<span class="co">#&gt; 19: 2020-03-11 gp_rt    235  2783   600  1505 1305.5  1485.954    952.6774</span>
<span class="co">#&gt; 20: 2020-03-12 gp_rt    363  3704   662  1952 1762.0  1974.768   1193.0974</span>
<span class="co">#&gt; 21: 2020-03-13 gp_rt    387  5392  1182  3024 2512.0  2913.637   1754.2430</span>
<span class="co">#&gt; 22: 2020-03-14 gp_rt    508  4702  1065  2713 2318.0  2630.658   1517.8944</span>
<span class="co">#&gt; 23: 2020-03-15 gp_rt    291  6401  1244  3561 3083.5  3603.214   2349.9933</span>
<span class="co">#&gt; 24: 2020-03-16 gp_rt    361  7293  1478  3918 3447.0  3997.599   2653.0104</span>
<span class="co">#&gt; 25: 2020-03-17 gp_rt    600  6784  1354  3710 3320.5  3796.676   2378.0071</span>
<span class="co">#&gt; 26: 2020-03-18 gp_rt    531  6631  1269  3762 3177.5  3671.629   2299.1788</span>
<span class="co">#&gt; 27: 2020-03-19 gp_rt    473  8521  1629  4758 4182.0  4736.369   2820.2003</span>
<span class="co">#&gt; 28: 2020-03-20 gp_rt    934 11059  2451  6198 5004.0  5907.992   3758.3171</span>
<span class="co">#&gt; 29: 2020-03-21 gp_rt   1106 10137  1610  4932 4452.5  5282.687   3540.8188</span>
<span class="co">#&gt; 30: 2020-03-22 gp_rt    889 11505  2587  6435 5292.5  6092.569   3747.1369</span>
<span class="co">#&gt; 31: 2020-03-23 gp_rt    860 11304  2227  6085 5329.0  6239.494   4068.0137</span>
<span class="co">#&gt; 32: 2020-03-24 gp_rt    522  9654  1889  5277 4764.5  5458.194   3299.4970</span>
<span class="co">#&gt; 33: 2020-03-25 gp_rt    521  8674  1765  4553 4145.5  4773.146   3007.6454</span>
<span class="co">#&gt; 34: 2020-03-26 gp_rt   1009 10336  2147  5909 4993.0  5728.587   3590.6238</span>
<span class="co">#&gt; 35: 2020-03-27 gp_rt    844 13076  3041  7527 6161.5  7094.678   4303.9854</span>
<span class="co">#&gt; 36: 2020-03-28 gp_rt    823 10165  1892  5484 4844.0  5586.406   3355.2740</span>
<span class="co">#&gt; 37: 2020-03-29 gp_rt    831 11039  2415  6337 5425.5  6207.469   3930.0675</span>
<span class="co">#&gt; 38: 2020-03-30 gp_rt   1243 10986  1713  5496 5129.0  6022.896   3609.6768</span>
<span class="co">#&gt; 39: 2020-03-31 gp_rt    909  9367  1910  5185 4421.5  5160.897   3149.5577</span>
<span class="co">#&gt; 40: 2020-04-01 gp_rt    348  7642  1710  4345 3744.0  4277.469   2549.6342</span>
<span class="co">#&gt; 41: 2020-04-02 gp_rt    882  9178  2083  5083 4349.5  5030.444   3092.2287</span>
<span class="co">#&gt; 42: 2020-04-03 gp_rt    887 10953  2379  6080 5180.0  5905.495   3709.7722</span>
<span class="co">#&gt; 43: 2020-04-04 gp_rt    505  8371  1645  4654 4169.5  4767.936   3193.6315</span>
<span class="co">#&gt; 44: 2020-04-05 gp_rt    549  9173  2354  5675 4347.5  5066.003   3179.3633</span>
<span class="co">#&gt; 45: 2020-04-06 gp_rt    629  8390  2010  4934 4097.5  4741.014   3097.1787</span>
<span class="co">#&gt; 46: 2020-04-07 gp_rt    574  7508  1423  3823 3422.5  4056.744   2575.7189</span>
<span class="co">#&gt; 47: 2020-04-08 gp_rt    593  6301  1415  3536 2868.5  3371.607   2072.2361</span>
<span class="co">#&gt; 48: 2020-04-09 gp_rt    358  7413  1365  3921 3385.0  4000.069   2595.5031</span>
<span class="co">#&gt; 49: 2020-04-10 gp_rt    451  8899  1423  4664 4064.0  4817.742   3330.3820</span>
<span class="co">#&gt; 50: 2020-04-11 gp_rt    367  6993  1344  3715 3072.0  3705.694   2456.8170</span>
<span class="co">#&gt; 51: 2020-04-12 gp_rt    448  8041  1085  3627 3337.0  4230.349   3306.0647</span>
<span class="co">#&gt; 52: 2020-04-13 gp_rt    327  7557  1566  3954 3151.0  4064.422   3366.0997</span>
<span class="co">#&gt; 53: 2020-04-14 gp_rt    388  7021   848  3013 2674.0  3656.382   3975.3395</span>
<span class="co">#&gt; 54: 2020-04-15 gp_rt    264  5990   445  2233 2115.0  3279.910   5432.8762</span>
<span class="co">#&gt; 55: 2020-04-16 gp_rt    242  7410   825  2899 2516.0  4699.695  14344.5823</span>
<span class="co">#&gt; 56: 2020-04-17 gp_rt    154  9266   751  3285 2998.5 11507.764 111677.8802</span>
<span class="co">#&gt; 57: 2020-04-18 gp_rt    242  8771   516  2477 2345.5 32563.633 594040.1764</span>
<span class="co">#&gt;           date  type bottom   top lower upper median      mean          sd</span>
</pre></div>
<p>A summary table is returned for rapidly understanding the results and for reporting purposes.</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">summary</span>
<span class="co">#&gt;                                  measure              estimate numeric_estimate</span>
<span class="co">#&gt; 1: New confirmed cases by infection date      1772 (2 -- 8917)     &lt;data.table&gt;</span>
<span class="co">#&gt; 2:        Expected change in daily cases                Unsure             0.71</span>
<span class="co">#&gt; 3:            Effective reproduction no.      0.8 (0.1 -- 1.5)     &lt;data.table&gt;</span>
<span class="co">#&gt; 4:                        Rate of growth -0.07 (-0.29 -- 0.14)     &lt;data.table&gt;</span>
<span class="co">#&gt; 5:          Doubling/halving time (days)   -10.1 (4.9 -- -2.4)     &lt;data.table&gt;</span>
</pre></div>
<p>A range of plots are returned (with the single summary plot shown below).</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">plots</span><span class="op">$</span><span class="kw">summary</span>
</pre></div>
<p><img src="reference/figures/unnamed-chunk-11-1.png"><!-- --></p>
</div>
<div id="regional-epinow" class="section level3">
<h3 class="hasAnchor">
<a href="#regional-epinow" class="anchor"></a><a href="https://epiforecasts.io/EpiNow2/reference/regional_epinow.html">Regional epinow</a>
</h3>
<p>This function runs the the <code>epinow</code> function across multiple regions in an efficient manner.</p>
<p>Define cases in multiple regions delineated by the region variable.</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="kw">reported_cases</span> <span class="op">&lt;-</span> <span class="kw">data.table</span>::<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbindlist</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
   <span class="kw">data.table</span>::<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html">copy</a></span>(<span class="kw">reported_cases</span>)[, <span class="kw">region</span> <span class="op">:=</span> <span class="st">"testland"</span>],
   <span class="kw">reported_cases</span>[, <span class="kw">region</span> <span class="op">:=</span> <span class="st">"realland"</span>]))

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">reported_cases</span>)
<span class="co">#&gt;          date confirm   region</span>
<span class="co">#&gt; 1: 2020-02-22      14 testland</span>
<span class="co">#&gt; 2: 2020-02-23      62 testland</span>
<span class="co">#&gt; 3: 2020-02-24      53 testland</span>
<span class="co">#&gt; 4: 2020-02-25      97 testland</span>
<span class="co">#&gt; 5: 2020-02-26      93 testland</span>
<span class="co">#&gt; 6: 2020-02-27      78 testland</span>
</pre></div>
<p>Run the pipeline on each region in turn. The commented code (requires the <code>{future}</code> package) can be used to run regions in parallel (when in most scenarios <code>cores</code> should be set to 1).</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="co">## future::plan("multisession")</span>
<span class="kw">estimates</span> <span class="op">&lt;-</span> <span class="kw">EpiNow2</span>::<span class="fu"><a href="reference/regional_epinow.html">regional_epinow</a></span>(reported_cases = <span class="kw">reported_cases</span>, 
                                      generation_time = <span class="kw">generation_time</span>,
                                      delays = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">incubation_period</span>, <span class="kw">reporting_delay</span>),
                                      horizon = <span class="fl">7</span>, samples = <span class="fl">1000</span>, warmup = <span class="fl">200</span>,
                                      cores = <span class="fl">4</span>, chains = <span class="fl">4</span>, adapt_delta = <span class="fl">0.95</span>,
                                      verbose = <span class="fl">TRUE</span>)
</pre></div>
<p>Results from each region are stored in a <code>regional</code> list with across region summary measures and plots stored in a <code>summary</code> list. All results can be set to be internally saved by setting the <code>target_folder</code> and <code>summary_dir</code> arguments.</p>
<p>Summary measures that are returned include a table formatted for reporting (along with raw results for further processing).</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">summary</span><span class="op">$</span><span class="kw">summarised_results</span><span class="op">$</span><span class="kw">table</span>
<span class="co">#&gt;      Region New confirmed cases by infection date</span>
<span class="co">#&gt; 1: realland                    1632 (21 -- 10366)</span>
<span class="co">#&gt; 2: testland                    1819 (12 -- 11225)</span>
<span class="co">#&gt;    Expected change in daily cases Effective reproduction no.</span>
<span class="co">#&gt; 1:                         Unsure           0.7 (0.1 -- 1.6)</span>
<span class="co">#&gt; 2:                         Unsure           0.8 (0.1 -- 1.6)</span>
<span class="co">#&gt;           Rate of growth Doubling/halving time (days)</span>
<span class="co">#&gt; 1:  -0.08 (-0.3 -- 0.16)           -9.2 (4.4 -- -2.3)</span>
<span class="co">#&gt; 2: -0.07 (-0.31 -- 0.17)          -10.2 (4.1 -- -2.3)</span>
</pre></div>
<p>A range of plots are again returned (with the single summary plot shown below).</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">summary</span><span class="op">$</span><span class="kw">summary_plot</span>
</pre></div>
<p><img src="reference/figures/unnamed-chunk-15-1.png"><!-- --></p>
</div>
<div id="reporting-templates" class="section level3">
<h3 class="hasAnchor">
<a href="#reporting-templates" class="anchor"></a>Reporting templates</h3>
<p>Rmarkdown templates are provided in the package (<code>templates</code>) for semi-automated reporting of estimates. These are currently undocumented but an example integration can be seen <a href="https://github.com/epiforecasts/covid/blob/master/_posts/national/united-kingdom/united-kingdom.Rmd">here</a>. If using these templates to report your results please highlight our <a href="https://epiforecasts.io/covid/">limitations</a> as these are key to understanding our results.</p>
</div>
</div>
<div id="contributing" class="section level2">
<h2 class="hasAnchor">
<a href="#contributing" class="anchor"></a>Contributing</h2>
<p>File an issue <a href="https://github.com/epiforecasts/EpiNow2/issues">here</a> if you have identified an issue with the package. Please note that due to operational constraints priority will be given to users informing government policy or offering methodological insights. We welcome all contributions, in particular those that improve the approach or the robustness of the code base.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Sam Abbott <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-8057-8037" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Joel Hellewell <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-2683-0849" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Robin Thompson <br><small class="roles"> Author </small>  </li>
<li>Katelyn Gostic <br><small class="roles"> Author </small>  </li>
<li>Katharine Sherratt <br><small class="roles"> Author </small>  </li>
<li>Sophie Meakin <br><small class="roles"> Author </small>  </li>
<li>James Munday <br><small class="roles"> Author </small>  </li>
<li>Nikos Bosse <br><small class="roles"> Author </small>  </li>
<li>Paul Mee <br><small class="roles"> Author </small>  </li>
<li>Sebastian Funk <br><small class="roles"> Author </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/epiforecasts/EpiNow2/actions"><img src="https://github.com/epiforecasts/EpiNow2/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://codecov.io/gh/epiforecasts/EpiNow2?branch=master"><img src="https://codecov.io/gh/epiforecasts/EpiNow2/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://zenodo.org/badge/latestdoi/247464257"><img src="https://zenodo.org/badge/247464257.svg" alt="DOI"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Sam Abbott, Joel Hellewell, Robin Thompson, Katelyn Gostic, Katharine Sherratt, Sophie Meakin, James Munday, Nikos Bosse, Paul Mee, Sebastian Funk.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
