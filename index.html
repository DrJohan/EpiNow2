<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimate Real-Time Case Counts and Time-Varying Epidemiological Parameters â€¢ EpiNow2</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Estimate Real-Time Case Counts and Time-Varying Epidemiological Parameters">
<meta property="og:description" content="Estimates the time-varying reproduction number, rate of spread,
             and doubling time using a range of open-source tools (Abbott et al. &lt;doi:10.12688/wellcomeopenres.16006.1&gt;),
             and current best practices (Gostic et al. &lt;doi:10.1101/2020.06.18.20134858&gt;).
             It aims to help users avoid some of the limitations of naive implementations in a framework
             that is informed by community feedback and is under active development.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">EpiNow2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
<li>
  <a href="reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/epiforecasts/EpiNow2">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="epinow2-estimate-real-time-case-counts-and-time-varying-epidemiological-parameters" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#epinow2-estimate-real-time-case-counts-and-time-varying-epidemiological-parameters" class="anchor"></a>EpiNow2: Estimate real-time case counts and time-varying epidemiological parameters</h1></div>

<p>This package estimates the time-varying reproduction number, rate of spread, and doubling time using a range of open-source tools (<a href="https://doi.org/10.12688/wellcomeopenres.16006.1">Abbott et al.</a>), and current best practices (<a href="https://doi.org/10.1101/2020.06.18.20134858">Gostic et al.</a>). It aims to help users avoid some of the limitations of naive implementations in a framework that is informed by community feedback and is under active development.</p>
<p>It estimates the time-varying reproduction number on cases by date of infection (using a similar approach to that implemented in the <a href="https://github.com/annecori/EpiEstim"><code>{EpiEstim}</code></a>). Imputed infections are then mapped to observed data (for example cases by date of report) via a series of uncertain delay distributions (in the examples in the package documentation these are an incubation period and a reporting delay) and a reporting model that can include weekly periodicity.</p>
<p>Uncertainty is propagated from all inputs into the final parameter estimates, helping to mitigate spurious findings. This is handled internally. The time-varying reproduction estimates and the uncertain generation time also give time-varying estimates of the rate of growth.</p>
<p>The default model uses a non-stationary Gaussian process to estimate the time-varying reproduction number. Other options include:</p>
<ul>
<li>A stationary Gaussian process (faster to estimate but currently gives reduced performance for real time estimates).</li>
<li>User specified breakpoints.</li>
<li>As a constant.</li>
<li>As piecewise constant by combining a fixed reproduction number with breakpoints.</li>
<li>As a random walk (by combining a fixed reproduction number with regularly spaced breakpoints (i.e weekly)).</li>
</ul>
<p>The documentation for <a href="https://epiforecasts.io/EpiNow2/reference/estimate_infections.html"><code>estimate_infections</code></a> provides examples of the different options available.</p>
<p>Forecasting is also supported for the time-varying reproduction number, infections and reported cases. The time-varying reproduction number can be forecast forwards in time using an integration with the <a href="https://epiforecasts.io/EpiSoon"><code>{EpiSoon}</code></a> package, and converted to a case forecast using the renewal equation. Alternatively, the time-varying reproduction number and cases can be forecast using a Gaussian process.</p>
<p>As a standalone tool, non-parametric back-calculation is also supported. This uses a novel formulation based on a smoothed mean delay shift of reported cases combined with a Gaussian process to determine the most likely outbreak trajectory. Again see the documentation for <a href="https://epiforecasts.io/EpiNow2/reference/estimate_infections.html"><code>estimate_infections</code></a> for an example.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Install the stable version of the package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"EpiNow2"</span>)
</pre></div>
<p>Install the stable development version of the package using <a href="https://epiforecasts.io/drat/"><code>{drat}</code></a>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"drat"</span>)
<span class="kw">drat</span>:::<span class="fu">add</span>(<span class="st">"epiforecasts"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"EpiNow2"</span>)
</pre></div>
<p>Install the unstable development version of the package with:</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw">remotes</span>::<span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span>(<span class="st">"epiforecasts/EpiNow2"</span>)
</pre></div>
<p>Windows users will need a working installation of Rtools in order to build the package from source. See <a href="https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#checking-the-c-toolchain">here</a> for a guide to installing Rtools for use with Stan (which is the statistical modeling platform used for the underlying model). For simple deployment/development a prebuilt docker image is also available (see documentation <a href="https://github.com/epiforecasts/EpiNow2/wiki/Docker">here</a>).</p>
</div>
<div id="quick-start" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-start" class="anchor"></a>Quick start</h2>
<p><code>{EpiNow2}</code> is designed to be used with a single function call or to be used in an ad-hoc fashion via individual function calls. In the following section we give an overview of the simple use case. For more on using each function see the <a href="https://epiforecasts.io/EpiNow2/reference/index.html">function documentation</a>. The core functions are: <a href="https://epiforecasts.io/EpiNow2/reference/epinow.html"><code>epinow</code></a>, <a href="https://epiforecasts.io/EpiNow2/reference/epinow.html"><code>regional_epinow</code></a>, <a href="https://epiforecasts.io/EpiNow2/reference/estimate_infections.html"><code>estimate_infections</code></a>, and <a href="https://epiforecasts.io/EpiNow2/reference/forecast_infections.html"><code>forecast_infections</code></a>. <a href="https://epiforecasts.io/EpiNow2/reference/estimate_infections.html"><code>estimate_infections</code></a> can be use on its own to infer the underlying infection case curve from reported cases with Rt optionally returned (on by default). Estimating the underlying infection case curve alone is substantially less computationally demanding than also estimating Rt.</p>
<div id="reporting-delays-incubation-period-and-generation-time" class="section level3">
<h3 class="hasAnchor">
<a href="#reporting-delays-incubation-period-and-generation-time" class="anchor"></a>Reporting delays, incubation period and generation time</h3>
<p>Distributions can either be fitted using package functionality or determined elsewhere and then defined with uncertainty for use in <code>{EpiNow2}</code>. When data is supplied a subsampled bootstrapped lognormal will be fit (to account for uncertainty in the observed data without being biased by changes in incidence). An arbitrary number of delay distributions are supported with the most common use case likely to be a incubation period followed by a reporting delay.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="kw">reporting_delay</span> <span class="op">&lt;-</span> <span class="kw">EpiNow2</span>::<span class="fu"><a href="reference/bootstrapped_dist_fit.html">bootstrapped_dist_fit</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html">rlnorm</a></span>(<span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="fl">6</span>), <span class="fl">1</span>))
<span class="co">## Set max allowed delay to 30 days to truncate computation</span>
<span class="kw">reporting_delay</span><span class="op">$</span><span class="kw">max</span> <span class="op">&lt;-</span> <span class="fl">30</span>

<span class="kw">reporting_delay</span>
<span class="co">#&gt; $mean</span>
<span class="co">#&gt; [1] 1.970138</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mean_sd</span>
<span class="co">#&gt; [1] 0.1681175</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd</span>
<span class="co">#&gt; [1] 1.025332</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd_sd</span>
<span class="co">#&gt; [1] 0.1058058</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max</span>
<span class="co">#&gt; [1] 30</span>
</pre></div>
<p>Here we define the incubation period and generation time based on literature estimates for Covid-19 (see <a href="https://github.com/epiforecasts/EpiNow/tree/master/data-raw">here</a> for the code that generates these estimates).</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="kw">generation_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(mean = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">mean</span>,
                        mean_sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">mean_sd</span>,
                         sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">sd</span>,
                         sd_sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">sd_sd</span>,
                         max = <span class="fl">30</span>)

<span class="kw">incubation_period</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(mean = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">mean</span>,
                          mean_sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">mean_sd</span>,
                          sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">sd</span>,
                          sd_sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">sd_sd</span>,
                          max = <span class="fl">30</span>)
</pre></div>
</div>
<div id="epinow" class="section level3">
<h3 class="hasAnchor">
<a href="#epinow" class="anchor"></a><a href="https://epiforecasts.io/EpiNow2/reference/epinow.html">epinow</a>
</h3>
<p>This function represents the core functionality of the package and includes results reporting, plotting and optional saving. It requires a data frame of cases by date of report and the distributions defined above. An additional forecasting module is supported via <code>EpiSoon</code> and companion packages (see documentation for an example).</p>
<p>Load example case data from <code>{EpiNow2}</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="kw">reported_cases</span> <span class="op">&lt;-</span> <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/example_confirmed.html">example_confirmed</a></span>[<span class="fl">1</span><span class="op">:</span><span class="fl">50</span>]

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">reported_cases</span>)
<span class="co">#&gt;          date confirm</span>
<span class="co">#&gt; 1: 2020-02-22      14</span>
<span class="co">#&gt; 2: 2020-02-23      62</span>
<span class="co">#&gt; 3: 2020-02-24      53</span>
<span class="co">#&gt; 4: 2020-02-25      97</span>
<span class="co">#&gt; 5: 2020-02-26      93</span>
<span class="co">#&gt; 6: 2020-02-27      78</span>
</pre></div>
<p>Estimate cases by date of infection, the time-varying reproduction number, the rate of growth and forecast these estimates into the future by 7 days. Summarise the posterior and return a summary table and plots for reporting purposes. If a <code>target_folder</code> is supplied results can be internally saved (with the option to also turn off explicit returning of results). <em>Note that for real use cases more samples and a longer warm up may be needed</em>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="kw">estimates</span> <span class="op">&lt;-</span> <span class="kw">EpiNow2</span>::<span class="fu"><a href="reference/epinow.html">epinow</a></span>(reported_cases = <span class="kw">reported_cases</span>, 
                             generation_time = <span class="kw">generation_time</span>,
                             delays = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">incubation_period</span>, <span class="kw">reporting_delay</span>),
                             horizon = <span class="fl">7</span>, samples = <span class="fl">1000</span>, warmup = <span class="fl">200</span>, 
                             cores = <span class="fl">4</span>, chains = <span class="fl">4</span>, verbose = <span class="fl">TRUE</span>, 
                             adapt_delta = <span class="fl">0.95</span>)

<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">estimates</span>)
<span class="co">#&gt; [1] "estimates"                "estimated_reported_cases"</span>
<span class="co">#&gt; [3] "summary"                  "plots"</span>
</pre></div>
<p>Both summary measures and posterior samples are returned for all parameters in an easily explored format.</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">estimates</span>
<span class="co">#&gt; $samples</span>
<span class="co">#&gt;                 variable        parameter time       date sample       value</span>
<span class="co">#&gt;      1:       infections       infections    1 2020-02-05      1    1.867327</span>
<span class="co">#&gt;      2:       infections       infections    2 2020-02-06      1   10.415739</span>
<span class="co">#&gt;      3:       infections       infections    3 2020-02-07      1   16.015825</span>
<span class="co">#&gt;      4:       infections       infections    4 2020-02-08      1   34.386094</span>
<span class="co">#&gt;      5:       infections       infections    5 2020-02-09      1   48.276454</span>
<span class="co">#&gt;     ---                                                                     </span>
<span class="co">#&gt; 258070: prior_infections prior_infections   70 2020-04-14      1 2455.552770</span>
<span class="co">#&gt; 258071: prior_infections prior_infections   71 2020-04-15      1 2394.825740</span>
<span class="co">#&gt; 258072: prior_infections prior_infections   72 2020-04-16      1 2335.600519</span>
<span class="co">#&gt; 258073: prior_infections prior_infections   73 2020-04-17      1 2277.839967</span>
<span class="co">#&gt; 258074: prior_infections prior_infections   74 2020-04-18      1 2221.507862</span>
<span class="co">#&gt;         strat     type</span>
<span class="co">#&gt;      1:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;      2:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;      3:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;      4:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;      5:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;     ---               </span>
<span class="co">#&gt; 258070:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; 258071:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; 258072:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; 258073:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; 258074:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summarised</span>
<span class="co">#&gt;            date       variable strat     type      bottom         top</span>
<span class="co">#&gt;   1: 2020-02-22              R  &lt;NA&gt; estimate   0.5684197    1.326612</span>
<span class="co">#&gt;   2: 2020-02-23              R  &lt;NA&gt; estimate   0.6689788    1.327115</span>
<span class="co">#&gt;   3: 2020-02-24              R  &lt;NA&gt; estimate   0.7843623    1.335338</span>
<span class="co">#&gt;   4: 2020-02-25              R  &lt;NA&gt; estimate   0.9199542    1.374425</span>
<span class="co">#&gt;   5: 2020-02-26              R  &lt;NA&gt; estimate   1.0311702    1.403387</span>
<span class="co">#&gt;  ---                                                                 </span>
<span class="co">#&gt; 328: 2020-04-14 reported_cases  &lt;NA&gt; forecast 271.0000000 6530.000000</span>
<span class="co">#&gt; 329: 2020-04-15 reported_cases  &lt;NA&gt; forecast 250.0000000 5754.000000</span>
<span class="co">#&gt; 330: 2020-04-16 reported_cases  &lt;NA&gt; forecast 194.0000000 7529.000000</span>
<span class="co">#&gt; 331: 2020-04-17 reported_cases  &lt;NA&gt; forecast 175.0000000 9305.000000</span>
<span class="co">#&gt; 332: 2020-04-18 reported_cases  &lt;NA&gt; forecast 185.0000000 7511.000000</span>
<span class="co">#&gt;            lower       upper       median         mean           sd</span>
<span class="co">#&gt;   1:   0.7517412    1.047230    0.9197803    0.9378134 2.289810e-01</span>
<span class="co">#&gt;   2:   0.8574849    1.111401    0.9812533    0.9931448 2.000579e-01</span>
<span class="co">#&gt;   3:   0.9151091    1.137584    1.0556009    1.0586086 1.707855e-01</span>
<span class="co">#&gt;   4:   1.0358071    1.223475    1.1305832    1.1335666 1.420613e-01</span>
<span class="co">#&gt;   5:   1.1415192    1.296867    1.2133702    1.2167753 1.165027e-01</span>
<span class="co">#&gt;  ---                                                               </span>
<span class="co">#&gt; 328: 812.0000000 2861.000000 2619.0000000 3408.0960000 3.077887e+03</span>
<span class="co">#&gt; 329: 590.0000000 2305.000000 2080.5000000 3085.2360000 4.127134e+03</span>
<span class="co">#&gt; 330: 787.0000000 2813.000000 2438.0000000 3891.4520000 5.831976e+03</span>
<span class="co">#&gt; 331: 711.0000000 3160.000000 2891.5000000 5133.8350000 9.891106e+03</span>
<span class="co">#&gt; 332: 539.0000000 2367.000000 2188.0000000 5545.4320000 2.827589e+04</span>
</pre></div>
<p>Reported cases are returned separately in order to ease reporting of forecasts and model evaluation.</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">estimated_reported_cases</span>
<span class="co">#&gt; $samples</span>
<span class="co">#&gt;              date sample cases  type</span>
<span class="co">#&gt;     1: 2020-02-22      1   203 gp_rt</span>
<span class="co">#&gt;     2: 2020-02-23      1   341 gp_rt</span>
<span class="co">#&gt;     3: 2020-02-24      1    53 gp_rt</span>
<span class="co">#&gt;     4: 2020-02-25      1   110 gp_rt</span>
<span class="co">#&gt;     5: 2020-02-26      1    47 gp_rt</span>
<span class="co">#&gt;    ---                              </span>
<span class="co">#&gt; 56996: 2020-04-14   1000  3775 gp_rt</span>
<span class="co">#&gt; 56997: 2020-04-15   1000  4102 gp_rt</span>
<span class="co">#&gt; 56998: 2020-04-16   1000  5934 gp_rt</span>
<span class="co">#&gt; 56999: 2020-04-17   1000 11467 gp_rt</span>
<span class="co">#&gt; 57000: 2020-04-18   1000 11121 gp_rt</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summarised</span>
<span class="co">#&gt;           date  type bottom   top lower upper median     mean         sd</span>
<span class="co">#&gt;  1: 2020-02-22 gp_rt     35   330    57   175  159.0  178.002   103.4936</span>
<span class="co">#&gt;  2: 2020-02-23 gp_rt     30   430    69   227  211.0  240.528   150.2495</span>
<span class="co">#&gt;  3: 2020-02-24 gp_rt     38   493   121   292  242.0  276.120   161.1148</span>
<span class="co">#&gt;  4: 2020-02-25 gp_rt     44   508    91   264  237.5  274.978   163.7934</span>
<span class="co">#&gt;  5: 2020-02-26 gp_rt     48   478   105   264  230.5  266.161   162.8148</span>
<span class="co">#&gt;  6: 2020-02-27 gp_rt     70   634   153   366  298.0  342.531   202.6564</span>
<span class="co">#&gt;  7: 2020-02-28 gp_rt     82   879   184   471  388.5  458.013   275.4754</span>
<span class="co">#&gt;  8: 2020-02-29 gp_rt     55   706   149   410  350.5  394.607   248.7836</span>
<span class="co">#&gt;  9: 2020-03-01 gp_rt     64   877   143   464  418.5  486.548   287.7215</span>
<span class="co">#&gt; 10: 2020-03-02 gp_rt     94   965   230   537  441.0  508.601   321.3313</span>
<span class="co">#&gt; 11: 2020-03-03 gp_rt    109   979   195   513  440.5  513.409   319.7521</span>
<span class="co">#&gt; 12: 2020-03-04 gp_rt     50   922   175   482  414.5  494.278   335.9354</span>
<span class="co">#&gt; 13: 2020-03-05 gp_rt     90  1209   280   706  593.0  671.070   406.4826</span>
<span class="co">#&gt; 14: 2020-03-06 gp_rt    130  1690   403   978  782.5  899.535   555.0464</span>
<span class="co">#&gt; 15: 2020-03-07 gp_rt    118  1627   297   850  748.0  869.909   597.1382</span>
<span class="co">#&gt; 16: 2020-03-08 gp_rt    172  2150   420  1107  946.5 1136.650   725.3866</span>
<span class="co">#&gt; 17: 2020-03-09 gp_rt    216  2444   436  1301 1163.0 1334.771   819.6695</span>
<span class="co">#&gt; 18: 2020-03-10 gp_rt    170  2552   660  1511 1230.0 1408.187   856.6881</span>
<span class="co">#&gt; 19: 2020-03-11 gp_rt    260  2525   600  1456 1223.5 1398.798   868.1106</span>
<span class="co">#&gt; 20: 2020-03-12 gp_rt    190  3658   648  1949 1772.5 2030.691  1291.7425</span>
<span class="co">#&gt; 21: 2020-03-13 gp_rt    381  5188  1055  2824 2562.5 2852.796  1756.5564</span>
<span class="co">#&gt; 22: 2020-03-14 gp_rt    452  4969   957  2664 2279.0 2674.353  1687.2145</span>
<span class="co">#&gt; 23: 2020-03-15 gp_rt    500  6199  1171  3417 2980.5 3398.346  2109.9632</span>
<span class="co">#&gt; 24: 2020-03-16 gp_rt    689  7241  1586  4025 3417.5 3877.684  2368.5666</span>
<span class="co">#&gt; 25: 2020-03-17 gp_rt    477  6890  1622  3995 3330.0 3815.714  2380.7079</span>
<span class="co">#&gt; 26: 2020-03-18 gp_rt    516  6524  1775  3859 3147.5 3516.918  2162.5979</span>
<span class="co">#&gt; 27: 2020-03-19 gp_rt    668  8604  1734  4661 4011.0 4590.306  2838.5552</span>
<span class="co">#&gt; 28: 2020-03-20 gp_rt   1007 10713  2114  5702 5161.5 6012.918  3686.1710</span>
<span class="co">#&gt; 29: 2020-03-21 gp_rt    804  9585  1875  5014 4453.5 5174.663  3230.3387</span>
<span class="co">#&gt; 30: 2020-03-22 gp_rt   1060 11609  3181  7203 5339.5 6226.785  3804.4701</span>
<span class="co">#&gt; 31: 2020-03-23 gp_rt    928 11046  2548  6536 5295.0 6015.854  3787.9038</span>
<span class="co">#&gt; 32: 2020-03-24 gp_rt    714  9577  2208  5678 5035.5 5623.255  3131.5741</span>
<span class="co">#&gt; 33: 2020-03-25 gp_rt    804  9030  2327  5436 4453.5 4933.506  2894.2815</span>
<span class="co">#&gt; 34: 2020-03-26 gp_rt    897 10785  2496  6139 5192.0 5960.224  3556.3619</span>
<span class="co">#&gt; 35: 2020-03-27 gp_rt   1155 13188  3181  7527 6185.0 7120.340  4378.3017</span>
<span class="co">#&gt; 36: 2020-03-28 gp_rt    578  9950  2453  6294 5241.0 5726.994  3362.1852</span>
<span class="co">#&gt; 37: 2020-03-29 gp_rt    906 11538  2671  6388 5453.0 6247.617  3685.9409</span>
<span class="co">#&gt; 38: 2020-03-30 gp_rt    710 11576  2224  6272 5442.5 6238.940  3851.1992</span>
<span class="co">#&gt; 39: 2020-03-31 gp_rt    704  9942  2182  5711 4675.5 5458.867  3409.6736</span>
<span class="co">#&gt; 40: 2020-04-01 gp_rt    807  7992  1659  4347 3725.0 4271.485  2573.2166</span>
<span class="co">#&gt; 41: 2020-04-02 gp_rt    641  9259  2058  5431 4457.5 5100.306  3164.3220</span>
<span class="co">#&gt; 42: 2020-04-03 gp_rt    881 10902  2355  6344 5364.0 6018.117  3626.1481</span>
<span class="co">#&gt; 43: 2020-04-04 gp_rt    963  8466  2021  4932 4198.5 4744.331  2913.0317</span>
<span class="co">#&gt; 44: 2020-04-05 gp_rt    853  9021  2193  5106 4314.0 4995.766  3008.5090</span>
<span class="co">#&gt; 45: 2020-04-06 gp_rt    617  9093  1857  5242 4296.0 4924.858  3119.8174</span>
<span class="co">#&gt; 46: 2020-04-07 gp_rt    511  7265  1847  4312 3525.5 4102.753  2592.8138</span>
<span class="co">#&gt; 47: 2020-04-08 gp_rt    498  6118  1257  3397 2892.5 3340.726  2164.0422</span>
<span class="co">#&gt; 48: 2020-04-09 gp_rt    524  7257  1761  4320 3478.5 3989.107  2569.6792</span>
<span class="co">#&gt; 49: 2020-04-10 gp_rt    515  8716  1879  4772 3995.0 4709.114  3203.5281</span>
<span class="co">#&gt; 50: 2020-04-11 gp_rt    514  7192  1118  3446 3130.5 3684.906  2454.1989</span>
<span class="co">#&gt; 51: 2020-04-12 gp_rt    406  7921   999  3589 3221.0 3994.946  2896.3762</span>
<span class="co">#&gt; 52: 2020-04-13 gp_rt    326  7236   980  3419 3099.0 3783.081  2755.6814</span>
<span class="co">#&gt; 53: 2020-04-14 gp_rt    271  6530   812  2861 2619.0 3408.096  3077.8866</span>
<span class="co">#&gt; 54: 2020-04-15 gp_rt    250  5754   590  2305 2080.5 3085.236  4127.1344</span>
<span class="co">#&gt; 55: 2020-04-16 gp_rt    194  7529   787  2813 2438.0 3891.452  5831.9764</span>
<span class="co">#&gt; 56: 2020-04-17 gp_rt    175  9305   711  3160 2891.5 5133.835  9891.1058</span>
<span class="co">#&gt; 57: 2020-04-18 gp_rt    185  7511   539  2367 2188.0 5545.432 28275.8934</span>
<span class="co">#&gt;           date  type bottom   top lower upper median     mean         sd</span>
</pre></div>
<p>A summary table is returned for rapidly understanding the results and for reporting purposes.</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">summary</span>
<span class="co">#&gt;                                  measure              estimate</span>
<span class="co">#&gt; 1: New confirmed cases by infection date      1448 (8 -- 8726)</span>
<span class="co">#&gt; 2:        Expected change in daily cases                Unsure</span>
<span class="co">#&gt; 3:            Effective reproduction no.      0.7 (0.1 -- 1.5)</span>
<span class="co">#&gt; 4:                        Rate of growth -0.08 (-0.28 -- 0.15)</span>
<span class="co">#&gt; 5:          Doubling/halving time (days)    -8.8 (4.6 -- -2.5)</span>
<span class="co">#&gt;     numeric_estimate</span>
<span class="co">#&gt; 1: &lt;data.table[1x5]&gt;</span>
<span class="co">#&gt; 2:              0.73</span>
<span class="co">#&gt; 3: &lt;data.table[1x5]&gt;</span>
<span class="co">#&gt; 4: &lt;data.table[1x5]&gt;</span>
<span class="co">#&gt; 5: &lt;data.table[1x3]&gt;</span>
</pre></div>
<p>A range of plots are returned (with the single summary plot shown below).</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">plots</span><span class="op">$</span><span class="kw">summary</span>
</pre></div>
<p><img src="reference/figures/unnamed-chunk-12-1.png"><!-- --></p>
</div>
<div id="regional-epinow" class="section level3">
<h3 class="hasAnchor">
<a href="#regional-epinow" class="anchor"></a><a href="https://epiforecasts.io/EpiNow2/reference/regional_epinow.html">Regional epinow</a>
</h3>
<p>This function runs the the <code>epinow</code> function across multiple regions in an efficient manner.</p>
<p>Define cases in multiple regions delineated by the region variable.</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="kw">reported_cases</span> <span class="op">&lt;-</span> <span class="kw">data.table</span>::<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbindlist</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
   <span class="kw">data.table</span>::<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html">copy</a></span>(<span class="kw">reported_cases</span>)[, <span class="kw">region</span> <span class="op">:=</span> <span class="st">"testland"</span>],
   <span class="kw">reported_cases</span>[, <span class="kw">region</span> <span class="op">:=</span> <span class="st">"realland"</span>]))

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">reported_cases</span>)
<span class="co">#&gt;          date confirm   region</span>
<span class="co">#&gt; 1: 2020-02-22      14 testland</span>
<span class="co">#&gt; 2: 2020-02-23      62 testland</span>
<span class="co">#&gt; 3: 2020-02-24      53 testland</span>
<span class="co">#&gt; 4: 2020-02-25      97 testland</span>
<span class="co">#&gt; 5: 2020-02-26      93 testland</span>
<span class="co">#&gt; 6: 2020-02-27      78 testland</span>
</pre></div>
<p>Run the pipeline on each region in turn. The commented code (requires the <code>{future}</code> package) can be used to run regions in parallel (when in most scenarios <code>cores</code> should be set to 1).</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="co">## future::plan("multisession")</span>
<span class="kw">estimates</span> <span class="op">&lt;-</span> <span class="kw">EpiNow2</span>::<span class="fu"><a href="reference/regional_epinow.html">regional_epinow</a></span>(reported_cases = <span class="kw">reported_cases</span>, 
                                      generation_time = <span class="kw">generation_time</span>,
                                      delays = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">incubation_period</span>, <span class="kw">reporting_delay</span>),
                                      horizon = <span class="fl">7</span>, samples = <span class="fl">1000</span>, warmup = <span class="fl">200</span>,
                                      cores = <span class="fl">4</span>, chains = <span class="fl">4</span>, adapt_delta = <span class="fl">0.95</span>,
                                      verbose = <span class="fl">TRUE</span>)
</pre></div>
<p>Results from each region are stored in a <code>regional</code> list with across region summary measures and plots stored in a <code>summary</code> list. All results can be set to be internally saved by setting the <code>target_folder</code> and <code>summary_dir</code> arguments.</p>
<p>Summary measures that are returned include a table formatted for reporting (along with raw results for further processing).</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">summary</span><span class="op">$</span><span class="kw">summarised_results</span><span class="op">$</span><span class="kw">table</span>
<span class="co">#&gt;      Region New confirmed cases by infection date</span>
<span class="co">#&gt; 1: realland                      1475 (1 -- 8980)</span>
<span class="co">#&gt; 2: testland                      1690 (2 -- 8781)</span>
<span class="co">#&gt;    Expected change in daily cases Effective reproduction no.</span>
<span class="co">#&gt; 1:                         Unsure           0.7 (0.1 -- 1.5)</span>
<span class="co">#&gt; 2:                         Unsure           0.8 (0.1 -- 1.5)</span>
<span class="co">#&gt;           Rate of growth Doubling/halving time (days)</span>
<span class="co">#&gt; 1: -0.08 (-0.29 -- 0.15)           -8.5 (4.5 -- -2.4)</span>
<span class="co">#&gt; 2: -0.07 (-0.32 -- 0.13)           -9.8 (5.4 -- -2.1)</span>
</pre></div>
<p>A range of plots are again returned (with the single summary plot shown below).</p>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">summary</span><span class="op">$</span><span class="kw">summary_plot</span>
</pre></div>
<p><img src="reference/figures/unnamed-chunk-16-1.png"><!-- --></p>
</div>
<div id="reporting-templates" class="section level3">
<h3 class="hasAnchor">
<a href="#reporting-templates" class="anchor"></a>Reporting templates</h3>
<p>Rmarkdown templates are provided in the package (<code>templates</code>) for semi-automated reporting of estimates. These are currently undocumented but an example integration can be seen <a href="https://github.com/epiforecasts/covid/blob/master/_posts/national/united-kingdom/united-kingdom.Rmd">here</a>. If using these templates to report your results please highlight our <a href="https://doi.org/10.12688/wellcomeopenres.16006.1">limitations</a> as these are key to understanding the results from <code>{EpiNow2}</code> .</p>
</div>
</div>
<div id="contributing" class="section level2">
<h2 class="hasAnchor">
<a href="#contributing" class="anchor"></a>Contributing</h2>
<p>File an issue <a href="https://github.com/epiforecasts/EpiNow2/issues">here</a> if you have identified an issue with the package. Please note that due to operational constraints priority will be given to users informing government policy or offering methodological insights. We welcome all contributions, in particular those that improve the approach or the robustness of the code base.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Sam Abbott <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-8057-8037" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Joel Hellewell <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-2683-0849" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Robin Thompson <br><small class="roles"> Author </small>  </li>
<li>Katelyn Gostic <br><small class="roles"> Author </small>  </li>
<li>Katharine Sherratt <br><small class="roles"> Author </small>  </li>
<li>Sophie Meakin <br><small class="roles"> Author </small>  </li>
<li>James Munday <br><small class="roles"> Author </small>  </li>
<li>Nikos Bosse <br><small class="roles"> Author </small>  </li>
<li>Joe Hickson <br><small class="roles"> Author </small>  </li>
<li>EpiForecasts <br><small class="roles"> Author </small>  </li>
<li>Sebastian Funk <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/epiforecasts/EpiNow2/actions"><img src="https://github.com/epiforecasts/EpiNow2/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://codecov.io/gh/epiforecasts/EpiNow2?branch=master"><img src="https://codecov.io/gh/epiforecasts/EpiNow2/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://zenodo.org/badge/latestdoi/272995211"><img src="https://zenodo.org/badge/272995211.svg" alt="DOI"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Sam Abbott, Joel Hellewell, Robin Thompson, Katelyn Gostic, Katharine Sherratt, Sophie Meakin, James Munday, Nikos Bosse, Joe Hickson, EpiForecasts, Sebastian Funk.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
