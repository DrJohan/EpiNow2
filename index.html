<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimate Real-Time Case Counts and Time-Varying Epidemiological Parameters  â€¢ EpiNow2</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Estimate Real-Time Case Counts and Time-Varying Epidemiological Parameters ">
<meta property="og:description" content="Estimates the time-varying reproduction number, rate of spread,
             and doubling time using a range of open-source tools (Abbott et al. &lt;doi:10.12688/wellcomeopenres.16006.1&gt;),
             and current best practices (Gostic et al. &lt;doi:10.1101/2020.06.18.20134858&gt;). 
             It aims to help users avoid some of the limitations of naive implementations in a framework
             that is informed by community feedback and is under active development.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">EpiNow2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
<li>
  <a href="reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/epiforecasts/EpiNow2">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="epinow2-estimate-real-time-case-counts-and-time-varying-epidemiological-parameters" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#epinow2-estimate-real-time-case-counts-and-time-varying-epidemiological-parameters" class="anchor"></a>EpiNow2: Estimate real-time case counts and time-varying epidemiological parameters</h1></div>

<p>This package estimates the time-varying reproduction number, rate of spread, and doubling time using a range of open-source tools (<a href="doi.org/10.12688/wellcomeopenres.16006.1">Abbott et al.</a>), and current best practices (<a href="doi.org/10.1101/2020.06.18.20134858">Gostic et al.</a>). It aims to help users avoid some of the limitations of naive implementations in a framework that is informed by community feedback and is under active development. It estimates the time-varying reproduction number on cases by date of infection (using a similar approach to that implemented in the <a href="https://github.com/annecori/EpiEstim"><code>{EpiEstim}</code></a>). Imputed infections are then mapped to observed data (for example cases by date of report) via a series of uncertain delay distributions (in the examples in the package documentation these are an incubation period and a reporting delay) and a reporting model that can include weekly periodicity. The default model uses a non-stationary Gaussian process to estimate the time-varying reproduction number but optionally a stationary Gaussian process may be used (faster to estimate but reduced performance for real time estimates) and arbitrary breakpoints can be defined. A fixed reproduction number is also supported. When combined with user defined breakpoints this gives the option of modelling the time-varying reproduction number as piecewise linear. The documentation for <a href="https://epiforecasts.io/EpiNow2/reference/estimate_infections.html"><code>estimate_infections</code></a> provides examples of the different options available. Propagating uncertainty from all inputs into the final parameter estimates (helping to mitigate spurious findings) is handled internally. Time-varying estimates of the rate of growth are derived from the time-varying reproduction estimates and the uncertain generation time. Optionally, the time-varying reproduction number can be forecast forwards in time using an integration with the <a href="https://epiforecasts.io/EpiSoon"><code>{EpiSoon}</code></a> package and converted to a case forecast using the renewal equation. Alternatively, the time-varying reproduction number and cases can be forecast using a Gaussian process. As a standalone tool non-parametric back-calculation is also supported using a novel formulation based on a smoothed mean delay shift of reported cases combined with a Gaussian process to determine the most likely outbreak trajectory.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Install the stable version of the package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"EpiNow2"</span>)
</pre></div>
<p>Install the stable development version of the package using <a href="https://epiforecasts.io/drat/"><code>{drat}</code></a>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"drat"</span>)
<span class="kw">drat</span>:::<span class="fu">add</span>(<span class="st">"epiforecasts"</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"EpiNow2"</span>)
</pre></div>
<p>Install the unstable development version of the package with:</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw">remotes</span>::<span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span>(<span class="st">"epiforecasts/EpiNow2"</span>)
</pre></div>
<p>Windows users will need a working installation of Rtools in order to build the package from source. See <a href="https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started#checking-the-c-toolchain">here</a> for a guide to installing Rtools for use with Stan (which is the statistical modeling platform used for the underlying model). For simple deployment/development a prebuilt docker image is also available (see documentation <a href="https://github.com/epiforecasts/EpiNow2/wiki/Docker">here</a>).</p>
</div>
<div id="quick-start" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-start" class="anchor"></a>Quick start</h2>
<p><code>{EpiNow}</code> is designed to be used with a single function call or to be used in an ad-hoc fashion via individual function calls. In the following section we give an overview of the simple use case. For more on using each function see the <a href="https://epiforecasts.io/EpiNow2/reference/index.html">function documentation</a>. The core functions are: <a href="https://epiforecasts.io/EpiNow2/reference/epinow.html"><code>epinow</code></a>, <a href="https://epiforecasts.io/EpiNow2/reference/epinow.html"><code>regional_epinow</code></a>, <a href="https://epiforecasts.io/EpiNow2/reference/estimate_infections.html"><code>estimate_infections</code></a>, and <a href="https://epiforecasts.io/EpiNow2/reference/forecast_infections.html"><code>forecast_infections</code></a>. <a href="https://epiforecasts.io/EpiNow2/reference/estimate_infections.html"><code>estimate_infections</code></a> can be use on its own to infer the underlying infection case curve from reported cases with Rt optionally returned (on by default). Estimating the underlying infection case curve alone is substantially less computationally demanding than also estimating Rt.</p>
<div id="reporting-delays-incubation-period-and-generation-time" class="section level3">
<h3 class="hasAnchor">
<a href="#reporting-delays-incubation-period-and-generation-time" class="anchor"></a>Reporting delays, incubation period and generation time</h3>
<p>Distributions can either be fitted using package functionality or determined elsewhere and then defined with uncertainty for use in <code>{EpiNow2}</code>. When data is supplied a subsampled bootstrapped lognormal will be fit (to account for uncertainty in the observed data without being biased by changes in incidence). An arbitrary number of delay distributions are supported with the most common use case likely to be a incubation period followed by a reporting delay.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="kw">reporting_delay</span> <span class="op">&lt;-</span> <span class="kw">EpiNow2</span>::<span class="fu"><a href="reference/bootstrapped_dist_fit.html">bootstrapped_dist_fit</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html">rlnorm</a></span>(<span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="fl">6</span>), <span class="fl">1</span>))
<span class="co">## Set max allowed delay to 30 days to truncate computation</span>
<span class="kw">reporting_delay</span><span class="op">$</span><span class="kw">max</span> <span class="op">&lt;-</span> <span class="fl">30</span>

<span class="kw">reporting_delay</span>
<span class="co">#&gt; $mean</span>
<span class="co">#&gt; [1] 1.545216</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $mean_sd</span>
<span class="co">#&gt; [1] 0.1324599</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd</span>
<span class="co">#&gt; [1] 1.049099</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sd_sd</span>
<span class="co">#&gt; [1] 0.1069301</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $max</span>
<span class="co">#&gt; [1] 30</span>
</pre></div>
<p>Here we define the incubation period and generation time based on literature estimates for Covid-19 (see <a href="https://github.com/epiforecasts/EpiNow/tree/master/data-raw">here</a> for the code that generates these estimates).</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="kw">generation_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(mean = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">mean</span>,
                        mean_sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">mean_sd</span>,
                         sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">sd</span>,
                         sd_sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_generation_times.html">covid_generation_times</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">sd_sd</span>,
                         max = <span class="fl">30</span>)

<span class="kw">incubation_period</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(mean = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">mean</span>,
                          mean_sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">mean_sd</span>,
                          sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">sd</span>,
                          sd_sd = <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/covid_incubation_period.html">covid_incubation_period</a></span>[<span class="fl">1</span>, ]<span class="op">$</span><span class="kw">sd_sd</span>,
                          max = <span class="fl">30</span>)
</pre></div>
</div>
<div id="epinow" class="section level3">
<h3 class="hasAnchor">
<a href="#epinow" class="anchor"></a><a href="https://epiforecasts.io/EpiNow2/reference/epinow.html">epinow</a>
</h3>
<p>This function represents the core functionality of the package and includes results reporting, plotting and optional saving. It requires a data frame of cases by date of report and the distributions defined above. An additional forecasting module is supported via <code>EpiSoon</code> and companion packages (see documentation for an example).</p>
<p>Load example case data from <code>{EpiNow2}</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="kw">reported_cases</span> <span class="op">&lt;-</span> <span class="kw">EpiNow2</span>::<span class="kw"><a href="reference/example_confirmed.html">example_confirmed</a></span>[<span class="fl">1</span><span class="op">:</span><span class="fl">50</span>]

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">reported_cases</span>)
<span class="co">#&gt;          date confirm</span>
<span class="co">#&gt; 1: 2020-02-22      14</span>
<span class="co">#&gt; 2: 2020-02-23      62</span>
<span class="co">#&gt; 3: 2020-02-24      53</span>
<span class="co">#&gt; 4: 2020-02-25      97</span>
<span class="co">#&gt; 5: 2020-02-26      93</span>
<span class="co">#&gt; 6: 2020-02-27      78</span>
</pre></div>
<p>Estimate cases by date of infection, the time-varying reproduction number, the rate of growth and forecast these estimates into the future by 7 days. Summarise the posterior and return a summary table and plots for reporting purposes. If a <code>target_folder</code> is supplied results can be internally saved (with the option to also turn off explicit returning of results). <em>Note that for real use cases more samples and a longer warm up may be needed</em>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="kw">estimates</span> <span class="op">&lt;-</span> <span class="kw">EpiNow2</span>::<span class="fu"><a href="reference/epinow.html">epinow</a></span>(reported_cases = <span class="kw">reported_cases</span>, 
                             generation_time = <span class="kw">generation_time</span>,
                             delays = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">incubation_period</span>, <span class="kw">reporting_delay</span>),
                             horizon = <span class="fl">7</span>, samples = <span class="fl">1000</span>, warmup = <span class="fl">200</span>, 
                             cores = <span class="fl">4</span>, chains = <span class="fl">4</span>, verbose = <span class="fl">TRUE</span>, 
                             adapt_delta = <span class="fl">0.95</span>)

<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="kw">estimates</span>)
<span class="co">#&gt; [1] "estimates"                "estimated_reported_cases"</span>
<span class="co">#&gt; [3] "summary"                  "plots"</span>
</pre></div>
<p>Both summary measures and posterior samples are returned for all parameters in an easily explored format.</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">estimates</span>
<span class="co">#&gt; $samples</span>
<span class="co">#&gt;                 variable        parameter time       date sample       value</span>
<span class="co">#&gt;      1:       infections       infections    1 2020-02-09      1    1.930685</span>
<span class="co">#&gt;      2:       infections       infections    2 2020-02-10      1   12.296683</span>
<span class="co">#&gt;      3:       infections       infections    3 2020-02-11      1   18.511373</span>
<span class="co">#&gt;      4:       infections       infections    4 2020-02-12      1   34.002092</span>
<span class="co">#&gt;      5:       infections       infections    5 2020-02-13      1   50.878446</span>
<span class="co">#&gt;     ---                                                                     </span>
<span class="co">#&gt; 254066: prior_infections prior_infections   66 2020-04-14      1 2714.255263</span>
<span class="co">#&gt; 254067: prior_infections prior_infections   67 2020-04-15      1 2647.130393</span>
<span class="co">#&gt; 254068: prior_infections prior_infections   68 2020-04-16      1 2581.665553</span>
<span class="co">#&gt; 254069: prior_infections prior_infections   69 2020-04-17      1 2517.819692</span>
<span class="co">#&gt; 254070: prior_infections prior_infections   70 2020-04-18      1 2455.552770</span>
<span class="co">#&gt;         strat     type</span>
<span class="co">#&gt;      1:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;      2:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;      3:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;      4:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;      5:  &lt;NA&gt; estimate</span>
<span class="co">#&gt;     ---               </span>
<span class="co">#&gt; 254066:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; 254067:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; 254068:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; 254069:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; 254070:  &lt;NA&gt; forecast</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summarised</span>
<span class="co">#&gt;            date       variable strat     type      bottom         top</span>
<span class="co">#&gt;   1: 2020-02-22              R  &lt;NA&gt; estimate   0.9976886    1.632718</span>
<span class="co">#&gt;   2: 2020-02-23              R  &lt;NA&gt; estimate   1.1341943    1.661147</span>
<span class="co">#&gt;   3: 2020-02-24              R  &lt;NA&gt; estimate   1.2077832    1.629813</span>
<span class="co">#&gt;   4: 2020-02-25              R  &lt;NA&gt; estimate   1.3241587    1.651037</span>
<span class="co">#&gt;   5: 2020-02-26              R  &lt;NA&gt; estimate   1.4040138    1.667489</span>
<span class="co">#&gt;  ---                                                                 </span>
<span class="co">#&gt; 320: 2020-04-14 reported_cases  &lt;NA&gt; forecast 645.0000000 6444.000000</span>
<span class="co">#&gt; 321: 2020-04-15 reported_cases  &lt;NA&gt; forecast 514.0000000 5265.000000</span>
<span class="co">#&gt; 322: 2020-04-16 reported_cases  &lt;NA&gt; forecast 493.0000000 6875.000000</span>
<span class="co">#&gt; 323: 2020-04-17 reported_cases  &lt;NA&gt; forecast 472.0000000 8417.000000</span>
<span class="co">#&gt; 324: 2020-04-18 reported_cases  &lt;NA&gt; forecast 484.0000000 7679.000000</span>
<span class="co">#&gt;            lower       upper      median        mean           sd</span>
<span class="co">#&gt;   1:    1.161898    1.432021    1.326492    1.332901 1.955253e-01</span>
<span class="co">#&gt;   2:    1.278200    1.500735    1.373163    1.378565 1.604993e-01</span>
<span class="co">#&gt;   3:    1.361885    1.538032    1.425563    1.429665 1.282570e-01</span>
<span class="co">#&gt;   4:    1.431844    1.566878    1.486481    1.484806 1.008667e-01</span>
<span class="co">#&gt;   5:    1.492757    1.599931    1.542450    1.542226 8.177660e-02</span>
<span class="co">#&gt;  ---                                                             </span>
<span class="co">#&gt; 320: 1491.000000 3263.000000 2935.000000 3533.298000 2.386467e+03</span>
<span class="co">#&gt; 321: 1212.000000 2857.000000 2432.500000 2988.752000 2.445418e+03</span>
<span class="co">#&gt; 322: 1139.000000 3186.000000 2804.500000 3801.958000 4.097769e+03</span>
<span class="co">#&gt; 323: 1372.000000 3685.000000 3198.000000 5214.320000 1.880585e+04</span>
<span class="co">#&gt; 324:  956.000000 2894.000000 2531.000000 4865.491000 2.108619e+04</span>
</pre></div>
<p>Reported cases are returned separately in order to ease reporting of forecasts and model evaluation.</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">estimated_reported_cases</span>
<span class="co">#&gt; $samples</span>
<span class="co">#&gt;              date sample cases  type</span>
<span class="co">#&gt;     1: 2020-02-22      1    72 gp_rt</span>
<span class="co">#&gt;     2: 2020-02-23      1   179 gp_rt</span>
<span class="co">#&gt;     3: 2020-02-24      1   253 gp_rt</span>
<span class="co">#&gt;     4: 2020-02-25      1   150 gp_rt</span>
<span class="co">#&gt;     5: 2020-02-26      1   133 gp_rt</span>
<span class="co">#&gt;    ---                              </span>
<span class="co">#&gt; 56996: 2020-04-14   1000  3577 gp_rt</span>
<span class="co">#&gt; 56997: 2020-04-15   1000  1793 gp_rt</span>
<span class="co">#&gt; 56998: 2020-04-16   1000  2103 gp_rt</span>
<span class="co">#&gt; 56999: 2020-04-17   1000   472 gp_rt</span>
<span class="co">#&gt; 57000: 2020-04-18   1000  2418 gp_rt</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $summarised</span>
<span class="co">#&gt;           date  type bottom   top lower upper median     mean          sd</span>
<span class="co">#&gt;  1: 2020-02-22 gp_rt     29   147    55   100   82.0   87.506    37.87097</span>
<span class="co">#&gt;  2: 2020-02-23 gp_rt     36   209    67   137  120.0  127.122    56.40657</span>
<span class="co">#&gt;  3: 2020-02-24 gp_rt     51   240    86   161  134.0  146.775    65.09033</span>
<span class="co">#&gt;  4: 2020-02-25 gp_rt     57   234    77   155  142.0  148.686    59.62819</span>
<span class="co">#&gt;  5: 2020-02-26 gp_rt     51   249    75   156  142.0  153.766    67.69020</span>
<span class="co">#&gt;  6: 2020-02-27 gp_rt     63   330   125   229  191.5  205.435    88.86615</span>
<span class="co">#&gt;  7: 2020-02-28 gp_rt     90   473   144   297  266.0  286.814   127.44537</span>
<span class="co">#&gt;  8: 2020-02-29 gp_rt    102   451   151   287  251.0  266.803   113.18316</span>
<span class="co">#&gt;  9: 2020-03-01 gp_rt    119   600   180   370  325.0  357.672   171.15426</span>
<span class="co">#&gt; 10: 2020-03-02 gp_rt    140   660   269   466  388.5  407.169   171.44603</span>
<span class="co">#&gt; 11: 2020-03-03 gp_rt    155   700   255   465  384.0  421.291   185.03628</span>
<span class="co">#&gt; 12: 2020-03-04 gp_rt    145   701   218   448  399.0  424.808   186.79433</span>
<span class="co">#&gt; 13: 2020-03-05 gp_rt    182  1003   329   640  568.5  612.244   270.90482</span>
<span class="co">#&gt; 14: 2020-03-06 gp_rt    333  1509   541   986  803.5  878.620   393.86980</span>
<span class="co">#&gt; 15: 2020-03-07 gp_rt    256  1356   454   888  801.0  866.045   373.52259</span>
<span class="co">#&gt; 16: 2020-03-08 gp_rt    391  1912   746  1338 1073.0 1162.320   507.78628</span>
<span class="co">#&gt; 17: 2020-03-09 gp_rt    419  2179   840  1562 1294.0 1381.053   578.44088</span>
<span class="co">#&gt; 18: 2020-03-10 gp_rt    499  2384   875  1578 1333.0 1428.703   619.72803</span>
<span class="co">#&gt; 19: 2020-03-11 gp_rt    580  2450   945  1705 1372.0 1455.251   634.73807</span>
<span class="co">#&gt; 20: 2020-03-12 gp_rt    597  3427  1241  2260 1929.0 2075.379   922.69655</span>
<span class="co">#&gt; 21: 2020-03-13 gp_rt    998  4721  1789  3248 2667.5 2848.014  1280.35860</span>
<span class="co">#&gt; 22: 2020-03-14 gp_rt    825  4422  1810  3261 2541.0 2716.711  1180.18493</span>
<span class="co">#&gt; 23: 2020-03-15 gp_rt   1115  5687  2041  3970 3251.5 3539.352  1630.38673</span>
<span class="co">#&gt; 24: 2020-03-16 gp_rt   1167  6252  2177  4161 3535.0 3798.382  1698.41383</span>
<span class="co">#&gt; 25: 2020-03-17 gp_rt   1130  6021  2330  4159 3520.5 3792.849  1699.05103</span>
<span class="co">#&gt; 26: 2020-03-18 gp_rt   1174  5699  2066  3832 3242.0 3492.269  1478.47621</span>
<span class="co">#&gt; 27: 2020-03-19 gp_rt   1516  7421  2604  4816 4173.5 4506.203  1940.88979</span>
<span class="co">#&gt; 28: 2020-03-20 gp_rt   1581  9287  3630  6642 5421.0 5835.917  2567.43570</span>
<span class="co">#&gt; 29: 2020-03-21 gp_rt   1648  8094  2945  5596 4688.5 4960.858  2177.20211</span>
<span class="co">#&gt; 30: 2020-03-22 gp_rt   2300  9718  3035  6267 5582.5 5865.234  2543.39541</span>
<span class="co">#&gt; 31: 2020-03-23 gp_rt   2046  9434  3076  6028 5545.5 5871.242  2504.05670</span>
<span class="co">#&gt; 32: 2020-03-24 gp_rt   1966  9077  3125  5995 5145.0 5526.615  2429.53809</span>
<span class="co">#&gt; 33: 2020-03-25 gp_rt   1433  7544  2858  5105 4317.0 4661.903  2115.48837</span>
<span class="co">#&gt; 34: 2020-03-26 gp_rt   1529  8713  3187  5926 5102.5 5555.179  2518.98884</span>
<span class="co">#&gt; 35: 2020-03-27 gp_rt   2330 10569  4246  7549 6134.5 6565.456  2845.39111</span>
<span class="co">#&gt; 36: 2020-03-28 gp_rt   1786  8842  3131  5825 5041.0 5402.342  2361.78178</span>
<span class="co">#&gt; 37: 2020-03-29 gp_rt   2167  9810  3204  6071 5527.5 6031.692  2588.90665</span>
<span class="co">#&gt; 38: 2020-03-30 gp_rt   2240  9985  3447  6605 5449.5 5880.109  2581.86211</span>
<span class="co">#&gt; 39: 2020-03-31 gp_rt   1280  8171  2882  5577 4611.0 5043.097  2393.20006</span>
<span class="co">#&gt; 40: 2020-04-01 gp_rt   1394  6799  2566  4615 3899.5 4192.570  1866.59196</span>
<span class="co">#&gt; 41: 2020-04-02 gp_rt   1645  8030  2739  5158 4556.0 4874.705  2174.57274</span>
<span class="co">#&gt; 42: 2020-04-03 gp_rt   1700  9283  3225  6061 5295.0 5751.349  2597.19810</span>
<span class="co">#&gt; 43: 2020-04-04 gp_rt   1635  7286  2853  5097 4217.5 4393.266  1852.38997</span>
<span class="co">#&gt; 44: 2020-04-05 gp_rt   1893  8614  3002  5578 4752.5 5061.313  2222.68043</span>
<span class="co">#&gt; 45: 2020-04-06 gp_rt   1427  7669  2720  5157 4395.0 4715.568  2269.74026</span>
<span class="co">#&gt; 46: 2020-04-07 gp_rt   1281  6627  2446  4535 3755.0 4052.492  1765.71419</span>
<span class="co">#&gt; 47: 2020-04-08 gp_rt   1237  5748  1886  3627 3114.5 3368.006  1534.13088</span>
<span class="co">#&gt; 48: 2020-04-09 gp_rt    930  6474  1896  4004 3521.0 3928.244  1870.66115</span>
<span class="co">#&gt; 49: 2020-04-10 gp_rt   1277  7421  2272  4808 4254.0 4571.091  2176.19018</span>
<span class="co">#&gt; 50: 2020-04-11 gp_rt   1071  6154  2027  3939 3252.5 3612.370  1767.25537</span>
<span class="co">#&gt; 51: 2020-04-12 gp_rt    848  6992  2282  4520 3655.5 4093.223  2175.25044</span>
<span class="co">#&gt; 52: 2020-04-13 gp_rt   1107  6857  1958  3975 3445.5 3904.479  2099.78271</span>
<span class="co">#&gt; 53: 2020-04-14 gp_rt    645  6444  1491  3263 2935.0 3533.298  2386.46652</span>
<span class="co">#&gt; 54: 2020-04-15 gp_rt    514  5265  1212  2857 2432.5 2988.752  2445.41752</span>
<span class="co">#&gt; 55: 2020-04-16 gp_rt    493  6875  1139  3186 2804.5 3801.958  4097.76886</span>
<span class="co">#&gt; 56: 2020-04-17 gp_rt    472  8417  1372  3685 3198.0 5214.320 18805.85271</span>
<span class="co">#&gt; 57: 2020-04-18 gp_rt    484  7679   956  2894 2531.0 4865.491 21086.18578</span>
<span class="co">#&gt;           date  type bottom   top lower upper median     mean          sd</span>
</pre></div>
<p>A summary table is returned for rapidly understanding the results and for reporting purposes.</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">summary</span>
<span class="co">#&gt;                                  measure              estimate</span>
<span class="co">#&gt; 1: New confirmed cases by infection date    2568 (150 -- 7862)</span>
<span class="co">#&gt; 2:        Expected change in daily cases                Unsure</span>
<span class="co">#&gt; 3:            Effective reproduction no.      0.8 (0.3 -- 1.5)</span>
<span class="co">#&gt; 4:                        Rate of growth -0.04 (-0.22 -- 0.12)</span>
<span class="co">#&gt; 5:          Doubling/halving time (days)   -15.4 (5.6 -- -3.2)</span>
<span class="co">#&gt;     numeric_estimate</span>
<span class="co">#&gt; 1: &lt;data.table[1x5]&gt;</span>
<span class="co">#&gt; 2:              0.67</span>
<span class="co">#&gt; 3: &lt;data.table[1x5]&gt;</span>
<span class="co">#&gt; 4: &lt;data.table[1x5]&gt;</span>
<span class="co">#&gt; 5: &lt;data.table[1x3]&gt;</span>
</pre></div>
<p>A range of plots are returned (with the single summary plot shown below).</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">plots</span><span class="op">$</span><span class="kw">summary</span>
</pre></div>
<p><img src="reference/figures/unnamed-chunk-12-1.png"><!-- --></p>
</div>
<div id="regional-epinow" class="section level3">
<h3 class="hasAnchor">
<a href="#regional-epinow" class="anchor"></a><a href="https://epiforecasts.io/EpiNow2/reference/regional_epinow.html">Regional epinow</a>
</h3>
<p>This function runs the the <code>epinow</code> function across multiple regions in an efficient manner.</p>
<p>Define cases in multiple regions delineated by the region variable.</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="kw">reported_cases</span> <span class="op">&lt;-</span> <span class="kw">data.table</span>::<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbindlist</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
   <span class="kw">data.table</span>::<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/copy.html">copy</a></span>(<span class="kw">reported_cases</span>)[, <span class="kw">region</span> <span class="op">:=</span> <span class="st">"testland"</span>],
   <span class="kw">reported_cases</span>[, <span class="kw">region</span> <span class="op">:=</span> <span class="st">"realland"</span>]))

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="kw">reported_cases</span>)
<span class="co">#&gt;          date confirm   region</span>
<span class="co">#&gt; 1: 2020-02-22      14 testland</span>
<span class="co">#&gt; 2: 2020-02-23      62 testland</span>
<span class="co">#&gt; 3: 2020-02-24      53 testland</span>
<span class="co">#&gt; 4: 2020-02-25      97 testland</span>
<span class="co">#&gt; 5: 2020-02-26      93 testland</span>
<span class="co">#&gt; 6: 2020-02-27      78 testland</span>
</pre></div>
<p>Run the pipeline on each region in turn. The commented code (requires the <code>{future}</code> package) can be used to run regions in parallel (when in most scenarios <code>cores</code> should be set to 1).</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="co">## future::plan("multisession")</span>
<span class="kw">estimates</span> <span class="op">&lt;-</span> <span class="kw">EpiNow2</span>::<span class="fu"><a href="reference/regional_epinow.html">regional_epinow</a></span>(reported_cases = <span class="kw">reported_cases</span>, 
                                      generation_time = <span class="kw">generation_time</span>,
                                      delays = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw">incubation_period</span>, <span class="kw">reporting_delay</span>),
                                      horizon = <span class="fl">7</span>, samples = <span class="fl">1000</span>, warmup = <span class="fl">200</span>,
                                      cores = <span class="fl">4</span>, chains = <span class="fl">4</span>, adapt_delta = <span class="fl">0.95</span>,
                                      verbose = <span class="fl">TRUE</span>)
</pre></div>
<p>Results from each region are stored in a <code>regional</code> list with across region summary measures and plots stored in a <code>summary</code> list. All results can be set to be internally saved by setting the <code>target_folder</code> and <code>summary_dir</code> arguments.</p>
<p>Summary measures that are returned include a table formatted for reporting (along with raw results for further processing).</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">summary</span><span class="op">$</span><span class="kw">summarised_results</span><span class="op">$</span><span class="kw">table</span>
<span class="co">#&gt;      Region New confirmed cases by infection date</span>
<span class="co">#&gt; 1: realland                    2524 (132 -- 7240)</span>
<span class="co">#&gt; 2: testland                    2564 (116 -- 7585)</span>
<span class="co">#&gt;    Expected change in daily cases Effective reproduction no.</span>
<span class="co">#&gt; 1:                         Unsure           0.8 (0.4 -- 1.4)</span>
<span class="co">#&gt; 2:                         Unsure           0.9 (0.4 -- 1.5)</span>
<span class="co">#&gt;           Rate of growth Doubling/halving time (days)</span>
<span class="co">#&gt; 1: -0.05 (-0.19 -- 0.13)            -14 (5.4 -- -3.7)</span>
<span class="co">#&gt; 2:  -0.04 (-0.2 -- 0.14)          -16.5 (5.1 -- -3.5)</span>
</pre></div>
<p>A range of plots are again returned (with the single summary plot shown below).</p>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="kw">estimates</span><span class="op">$</span><span class="kw">summary</span><span class="op">$</span><span class="kw">summary_plot</span>
</pre></div>
<p><img src="reference/figures/unnamed-chunk-16-1.png"><!-- --></p>
</div>
<div id="reporting-templates" class="section level3">
<h3 class="hasAnchor">
<a href="#reporting-templates" class="anchor"></a>Reporting templates</h3>
<p>Rmarkdown templates are provided in the package (<code>templates</code>) for semi-automated reporting of estimates. These are currently undocumented but an example integration can be seen <a href="https://github.com/epiforecasts/covid/blob/master/_posts/national/united-kingdom/united-kingdom.Rmd">here</a>. If using these templates to report your results please highlight our <a href="https://epiforecasts.io/covid/">limitations</a> as these are key to understanding our results.</p>
</div>
</div>
<div id="contributing" class="section level2">
<h2 class="hasAnchor">
<a href="#contributing" class="anchor"></a>Contributing</h2>
<p>File an issue <a href="https://github.com/epiforecasts/EpiNow2/issues">here</a> if you have identified an issue with the package. Please note that due to operational constraints priority will be given to users informing government policy or offering methodological insights. We welcome all contributions, in particular those that improve the approach or the robustness of the code base.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Sam Abbott <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-8057-8037" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Joel Hellewell <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-2683-0849" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Robin Thompson <br><small class="roles"> Author </small>  </li>
<li>Katelyn Gostic <br><small class="roles"> Author </small>  </li>
<li>Katharine Sherratt <br><small class="roles"> Author </small>  </li>
<li>Sophie Meakin <br><small class="roles"> Author </small>  </li>
<li>James Munday <br><small class="roles"> Author </small>  </li>
<li>Nikos Bosse <br><small class="roles"> Author </small>  </li>
<li>Paul Mee <br><small class="roles"> Author </small>  </li>
<li>EpiForecasts <br><small class="roles"> Author </small>  </li>
<li>Sebastian Funk <br><small class="roles"> Author </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/epiforecasts/EpiNow2/actions"><img src="https://github.com/epiforecasts/EpiNow2/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://codecov.io/gh/epiforecasts/EpiNow2?branch=master"><img src="https://codecov.io/gh/epiforecasts/EpiNow2/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://zenodo.org/badge/latestdoi/272995211"><img src="https://zenodo.org/badge/272995211.svg" alt="DOI"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Sam Abbott, Joel Hellewell, Robin Thompson, Katelyn Gostic, Katharine Sherratt, Sophie Meakin, James Munday, Nikos Bosse, Paul Mee, EpiForecasts, Sebastian Funk.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
