<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Real-time Rt Estimation, Forecasting and Reporting — epinow • EpiNow2</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Real-time Rt Estimation, Forecasting and Reporting — epinow" />
<meta property="og:description" content="This function wraps the functionality of estimate_infections and forecast_infections in order
to estimate Rt and cases by date of infection, forecast into these infections into the future. It also contains
additional functionality to convert forecasts to date of report and produce summary output useful for reporting
results and interpreting them." />
<meta property="og:image" content="epiforecasts.io/EpiNow2/reference/figures/unnamed-chunk-13-1.png" />
<meta property="og:image:alt" content="Example estimates produced by EpiNow2 of the reproduction number, cases by date of infection and cases by date of report" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content="@seabbs" />
<meta name="twitter:site" content="@cmmid_lshtm" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">EpiNow2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Functions
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/epiforecasts/EpiNow2">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Real-time Rt Estimation, Forecasting and Reporting</h1>
    
    <div class="hidden name"><code>epinow.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function wraps the functionality of <code>estimate_infections</code> and <code>forecast_infections</code> in order
to estimate Rt and cases by date of infection, forecast into these infections into the future. It also contains
additional functionality to convert forecasts to date of report and produce summary output useful for reporting
results and interpreting them.</p>
    </div>

    <pre class="usage"><span class='fu'>epinow</span><span class='op'>(</span>
  <span class='va'>reported_cases</span>,
  samples <span class='op'>=</span> <span class='fl'>1000</span>,
  horizon <span class='op'>=</span> <span class='fl'>7</span>,
  <span class='va'>generation_time</span>,
  delays <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  CrIs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.2</span>, <span class='fl'>0.5</span>, <span class='fl'>0.9</span><span class='op'>)</span>,
  return_output <span class='op'>=</span> <span class='cn'>FALSE</span>,
  output <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"samples"</span>, <span class='st'>"plots"</span>, <span class='st'>"latest"</span><span class='op'>)</span>,
  target_folder <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>target_date</span>,
  forecast_args <span class='op'>=</span> <span class='cn'>NULL</span>,
  logs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span><span class='op'>(</span><span class='op'>)</span>,
  id <span class='op'>=</span> <span class='st'>"epinow"</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>reported_cases</th>
      <td><p>A data frame of confirmed cases (confirm) by date (date). confirm must be integer and date must be
in date format.</p></td>
    </tr>
    <tr>
      <th>samples</th>
      <td><p>Numeric, defaults to 1000. Number of samples post warmup.</p></td>
    </tr>
    <tr>
      <th>horizon</th>
      <td><p>Numeric, defaults to 7. Number of days into the future to forecast.</p></td>
    </tr>
    <tr>
      <th>generation_time</th>
      <td><p>A list containing the mean, standard deviation of the mean (mean_sd),
standard deviation (sd), standard deviation of the standard deviation and the maximum allowed value for the
generation time (assuming a gamma distribution).</p></td>
    </tr>
    <tr>
      <th>delays</th>
      <td><p>A list of delays (i.e incubation period/reporting delay) between infection and report.
Each list entry must also be a list containing the mean, standard deviation of the mean (mean_sd),
standard deviation (sd), standard deviation of the standard deviation and the maximum allowed value for the
that delay (assuming a lognormal distribution with all parameters excepting the max allowed value
on the log scale). To use no delays set this to <code><a href='https://rdrr.io/r/base/list.html'>list()</a></code>.</p></td>
    </tr>
    <tr>
      <th>CrIs</th>
      <td><p>Numeric vector of credible intervals to calculate.</p></td>
    </tr>
    <tr>
      <th>return_output</th>
      <td><p>Logical, defaults to FALSE. Should output be returned, this automatically updates to TRUE
if no directory for saving is specified.</p></td>
    </tr>
    <tr>
      <th>output</th>
      <td><p>A character vector of optional output to return. Supported options are samples ("samples"),
plots ("plots"), the run time ("timing"), copying the dated folder into a latest folder (if <code>target_folder</code> is not null</p><ul>
<li><p>set using "latest"), and the stan fit ("fit"). The default is to return samples and plots alongside summarised estimates
and summary statistics. This argument uses partial matching so for example passing "sam" will lead to samples
being reported.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>target_folder</th>
      <td><p>Character string specifying where to save results (will create if not present).</p></td>
    </tr>
    <tr>
      <th>target_date</th>
      <td><p>Date, defaults to maximum found in the data if not specified.</p></td>
    </tr>
    <tr>
      <th>forecast_args</th>
      <td><p>A list of arguments to pass to <code>forecast_infections</code>. Unless at a minimum a <code>forecast_model</code> is passed
tin his list then <code>forecast_infections</code> will be bypassed.</p></td>
    </tr>
    <tr>
      <th>logs</th>
      <td><p>Character path indicating the target folder in which to store log
information. Defaults to the temporary directory if not specified. Default logging
can be disabled if <code>logs</code> is set to NULL. If specifying a custom logging setup then
the code for <code>setup_default_logging</code> and the <code>setup_logging</code> function are a sensible
place to start.</p></td>
    </tr>
    <tr>
      <th>id</th>
      <td><p>A character string used to assign logging information on error. Used by <code>regional_epinow</code>
to assign <code>epinow</code> errors to regions.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Logical, defaults to <code>FALSE</code>. Should verbose debug progress messages be printed. Corresponds to the "DEBUG" level from
<code>futile.logger</code>. See <code>setup_logging</code> for more detailed logging options.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments passed to <code>estimate_infections</code>. See that functions documentation for options.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of output from estimate_infections, forecast_infections,  report_cases, and report_summary.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='co'># construct example distributions</span>
<span class='va'>generation_time</span> <span class='op'>&lt;-</span> <span class='fu'><a href='get_generation_time.html'>get_generation_time</a></span><span class='op'>(</span>disease <span class='op'>=</span> <span class='st'>"SARS-CoV-2"</span>, source <span class='op'>=</span> <span class='st'>"ganyani"</span><span class='op'>)</span>
<span class='va'>incubation_period</span> <span class='op'>&lt;-</span> <span class='fu'><a href='get_incubation_period.html'>get_incubation_period</a></span><span class='op'>(</span>disease <span class='op'>=</span> <span class='st'>"SARS-CoV-2"</span>, source <span class='op'>=</span> <span class='st'>"lauer"</span><span class='op'>)</span>
<span class='va'>reporting_delay</span> <span class='op'>&lt;-</span> <span class='fu'><a href='bootstrapped_dist_fit.html'>bootstrapped_dist_fit</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Lognormal.html'>rlnorm</a></span><span class='op'>(</span><span class='fl'>100</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>6</span><span class='op'>)</span>, <span class='fl'>1</span><span class='op'>)</span>, max_value <span class='op'>=</span> <span class='fl'>30</span><span class='op'>)</span>

<span class='co'># example case data</span>
<span class='va'>reported_cases</span> <span class='op'>&lt;-</span> <span class='fu'>EpiNow2</span><span class='fu'>::</span><span class='va'><a href='example_confirmed.html'>example_confirmed</a></span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>40</span><span class='op'>]</span> 

<span class='co'># estimate Rt and nowcast/forecast cases by date of infection</span>
<span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'>epinow</span><span class='op'>(</span>reported_cases <span class='op'>=</span> <span class='va'>reported_cases</span>, generation_time <span class='op'>=</span> <span class='va'>generation_time</span>,
              delays <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>incubation_period</span>, <span class='va'>reporting_delay</span><span class='op'>)</span>,
              stan_args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>cores <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='fl'>4</span>, <span class='fl'>1</span><span class='op'>)</span>,
              control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>adapt_delta <span class='op'>=</span> <span class='fl'>0.95</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Logging threshold set at INFO for the EpiNow2 logger</span></div><div class='output co'>#&gt; <span class='message'>Writing EpiNow2 logs to: /var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//Rtmp1ykgRW/regional-epinow/2020-04-01.log</span></div><div class='output co'>#&gt; <span class='message'>Logging threshold set at INFO for the EpiNow2.epinow logger</span></div><div class='output co'>#&gt; <span class='message'>Writing EpiNow2.epinow logs to: /var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//Rtmp1ykgRW/epinow/2020-04-01.log</span></div><div class='output co'>#&gt; <span class='message'>Logging threshold set at INFO for the EpiNow2.epinow.estimate_infections logger</span></div><div class='output co'>#&gt; <span class='message'>Writing EpiNow2.epinow.estimate_infections logs to: /var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//Rtmp1ykgRW/epinow-estimate-infections/2020-04-01.log</span></div><div class='output co'>#&gt; WARN [2020-10-16 12:16:11] epinow: There were 11 divergent transitions after warmup. See
#&gt; http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
#&gt; to find out why this is a problem and how to eliminate them. - 
#&gt; WARN [2020-10-16 12:16:11] epinow: Examine the pairs() plot to diagnose sampling problems
#&gt;  - 
#&gt; WARN [2020-10-16 12:16:12] epinow: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.
#&gt; Running the chains for more iterations may help. See
#&gt; http://mc-stan.org/misc/warnings.html#tail-ess - </div><div class='input'><span class='va'>out</span>
</div><div class='output co'>#&gt; $estimates
#&gt; $estimates$samples
#&gt;                 variable        parameter time       date sample       value
#&gt;      1:       infections       infections    1 2020-02-08      1    1.630602
#&gt;      2:       infections       infections    2 2020-02-09      1   12.187963
#&gt;      3:       infections       infections    3 2020-02-10      1   19.017616
#&gt;      4:       infections       infections    4 2020-02-11      1   32.497168
#&gt;      5:       infections       infections    5 2020-02-12      1   38.017022
#&gt;     ---                                                                     
#&gt; 215057: prior_infections prior_infections   57 2020-04-04      1 4562.019565
#&gt; 215058: prior_infections prior_infections   58 2020-04-05      1 4517.391996
#&gt; 215059: prior_infections prior_infections   59 2020-04-06      1 4473.200993
#&gt; 215060: prior_infections prior_infections   60 2020-04-07      1 4429.442284
#&gt; 215061: prior_infections prior_infections   61 2020-04-08      1 4386.111642
#&gt;         strat     type
#&gt;      1:  &lt;NA&gt; estimate
#&gt;      2:  &lt;NA&gt; estimate
#&gt;      3:  &lt;NA&gt; estimate
#&gt;      4:  &lt;NA&gt; estimate
#&gt;      5:  &lt;NA&gt; estimate
#&gt;     ---               
#&gt; 215057:  &lt;NA&gt; forecast
#&gt; 215058:  &lt;NA&gt; forecast
#&gt; 215059:  &lt;NA&gt; forecast
#&gt; 215060:  &lt;NA&gt; forecast
#&gt; 215061:  &lt;NA&gt; forecast
#&gt; 
#&gt; $estimates$summarised
#&gt;            date       variable strat     type      median        mean
#&gt;   1: 2020-02-22              R  &lt;NA&gt; estimate    1.357826    1.360536
#&gt;   2: 2020-02-23              R  &lt;NA&gt; estimate    1.409891    1.407608
#&gt;   3: 2020-02-24              R  &lt;NA&gt; estimate    1.461327    1.458628
#&gt;   4: 2020-02-25              R  &lt;NA&gt; estimate    1.511550    1.512001
#&gt;   5: 2020-02-26              R  &lt;NA&gt; estimate    1.563397    1.565790
#&gt;  ---                                                                 
#&gt; 272: 2020-04-04 reported_cases  &lt;NA&gt; forecast 3889.500000 4799.742000
#&gt; 273: 2020-04-05 reported_cases  &lt;NA&gt; forecast 4424.500000 5771.646000
#&gt; 274: 2020-04-06 reported_cases  &lt;NA&gt; forecast 4083.500000 5910.994000
#&gt; 275: 2020-04-07 reported_cases  &lt;NA&gt; forecast 3620.500000 5403.050000
#&gt; 276: 2020-04-08 reported_cases  &lt;NA&gt; forecast 2834.500000 4951.664000
#&gt;                sd     lower_90    lower_50    lower_20    upper_20    upper_50
#&gt;   1: 2.285914e-01    0.9875167    1.204365    1.319828    1.411440    1.506893
#&gt;   2: 1.866944e-01    1.0909402    1.280489    1.369066    1.457525    1.528403
#&gt;   3: 1.480604e-01    1.2054320    1.358315    1.428813    1.496581    1.555266
#&gt;   4: 1.156732e-01    1.3194656    1.435628    1.483653    1.540216    1.585197
#&gt;   5: 9.465121e-02    1.4159711    1.497616    1.538899    1.587122    1.626507
#&gt;  ---                                                                          
#&gt; 272: 3.464941e+03 1313.9500000 2576.250000 3289.200000 4559.600000 5983.250000
#&gt; 273: 4.745286e+03 1391.9500000 2836.750000 3756.200000 5286.400000 7034.250000
#&gt; 274: 7.720809e+03 1289.9000000 2552.000000 3425.800000 4880.800000 6749.000000
#&gt; 275: 8.411846e+03 1112.7500000 2216.750000 2977.400000 4332.800000 5983.750000
#&gt; 276: 1.179888e+04  844.4000000 1757.500000 2364.800000 3487.000000 4966.750000
#&gt;          upper_90
#&gt;   1:     1.713833
#&gt;   2:     1.711638
#&gt;   3:     1.699641
#&gt;   4:     1.702408
#&gt;   5:     1.731089
#&gt;  ---             
#&gt; 272: 11430.450000
#&gt; 273: 15371.250000
#&gt; 274: 15550.850000
#&gt; 275: 14599.250000
#&gt; 276: 13170.750000
#&gt; 
#&gt; 
#&gt; $estimated_reported_cases
#&gt; $estimated_reported_cases$samples
#&gt;              date sample cases  type
#&gt;     1: 2020-02-22      1    30 gp_rt
#&gt;     2: 2020-02-23      1   125 gp_rt
#&gt;     3: 2020-02-24      1   219 gp_rt
#&gt;     4: 2020-02-25      1    88 gp_rt
#&gt;     5: 2020-02-26      1   132 gp_rt
#&gt;    ---                              
#&gt; 46996: 2020-04-04   1000  4465 gp_rt
#&gt; 46997: 2020-04-05   1000  2656 gp_rt
#&gt; 46998: 2020-04-06   1000  3693 gp_rt
#&gt; 46999: 2020-04-07   1000  2025 gp_rt
#&gt; 47000: 2020-04-08   1000  1466 gp_rt
#&gt; 
#&gt; $estimated_reported_cases$summarised
#&gt;           date  type median     mean          sd lower_90 lower_50 lower_20
#&gt;  1: 2020-02-22 gp_rt   69.0   76.748    38.69923    27.00    49.00     62.0
#&gt;  2: 2020-02-23 gp_rt  109.0  120.030    60.22076    43.00    79.00     96.0
#&gt;  3: 2020-02-24 gp_rt  133.5  150.372    78.25068    51.00    95.00    116.0
#&gt;  4: 2020-02-25 gp_rt  144.0  158.478    80.21386    57.95    98.75    124.6
#&gt;  5: 2020-02-26 gp_rt  141.0  158.344    81.43444    57.00   101.00    127.0
#&gt;  6: 2020-02-27 gp_rt  200.5  219.197   116.21964    71.00   140.00    172.6
#&gt;  7: 2020-02-28 gp_rt  296.0  326.740   172.32443   119.95   213.75    261.0
#&gt;  8: 2020-02-29 gp_rt  255.5  283.736   153.23107   100.00   177.00    217.6
#&gt;  9: 2020-03-01 gp_rt  351.0  384.203   189.40665   132.95   246.75    316.0
#&gt; 10: 2020-03-02 gp_rt  397.0  439.062   229.98682   162.00   277.00    348.0
#&gt; 11: 2020-03-03 gp_rt  413.0  454.505   226.95425   160.95   297.75    363.0
#&gt; 12: 2020-03-04 gp_rt  408.5  443.750   228.89453   150.00   281.00    358.8
#&gt; 13: 2020-03-05 gp_rt  562.0  628.346   333.31442   220.85   390.75    492.6
#&gt; 14: 2020-03-06 gp_rt  841.0  937.390   487.77446   290.90   600.50    744.0
#&gt; 15: 2020-03-07 gp_rt  750.0  835.464   439.36157   277.80   524.00    665.6
#&gt; 16: 2020-03-08 gp_rt 1101.0 1217.743   650.03777   390.90   757.25    936.6
#&gt; 17: 2020-03-09 gp_rt 1262.0 1421.599   774.57436   464.00   868.75   1083.0
#&gt; 18: 2020-03-10 gp_rt 1355.0 1481.031   793.50161   486.95   919.00   1175.6
#&gt; 19: 2020-03-11 gp_rt 1300.0 1455.463   758.43501   494.85   941.75   1154.0
#&gt; 20: 2020-03-12 gp_rt 1837.0 2041.927  1071.54116   731.85  1296.50   1617.0
#&gt; 21: 2020-03-13 gp_rt 2677.5 3055.366  1683.47094  1096.00  1874.75   2373.2
#&gt; 22: 2020-03-14 gp_rt 2371.0 2644.672  1371.91139   925.55  1671.75   2136.8
#&gt; 23: 2020-03-15 gp_rt 3126.5 3520.248  1854.24140  1178.80  2221.00   2765.2
#&gt; 24: 2020-03-16 gp_rt 3447.0 3819.392  1997.37798  1308.25  2459.25   3066.2
#&gt; 25: 2020-03-17 gp_rt 3553.0 3938.462  2086.20688  1431.35  2471.75   3062.8
#&gt; 26: 2020-03-18 gp_rt 3217.5 3595.217  1963.92024  1159.50  2225.75   2798.8
#&gt; 27: 2020-03-19 gp_rt 4143.5 4574.228  2407.65960  1602.55  2869.75   3571.6
#&gt; 28: 2020-03-20 gp_rt 5371.0 6064.970  3192.03879  2083.50  3852.00   4752.8
#&gt; 29: 2020-03-21 gp_rt 4303.0 4912.480  2737.24725  1706.40  2979.50   3813.8
#&gt; 30: 2020-03-22 gp_rt 5628.5 6108.709  3142.13489  2240.65  3943.50   4908.2
#&gt; 31: 2020-03-23 gp_rt 5627.5 6222.936  3469.14627  2252.70  3859.00   4866.2
#&gt; 32: 2020-03-24 gp_rt 4984.0 5621.822  3057.22244  1975.65  3537.00   4351.6
#&gt; 33: 2020-03-25 gp_rt 4374.0 4831.416  2582.32827  1712.85  3003.75   3839.8
#&gt; 34: 2020-03-26 gp_rt 5081.5 5709.975  3178.05874  1938.65  3521.50   4413.8
#&gt; 35: 2020-03-27 gp_rt 6411.5 7159.962  3737.72674  2602.40  4574.25   5715.6
#&gt; 36: 2020-03-28 gp_rt 4770.0 5403.676  2856.23138  1801.75  3388.25   4207.2
#&gt; 37: 2020-03-29 gp_rt 5616.5 6211.770  3239.03006  2192.95  3990.50   4930.6
#&gt; 38: 2020-03-30 gp_rt 5503.0 6158.420  3675.68285  2044.70  3892.75   4800.6
#&gt; 39: 2020-03-31 gp_rt 4736.5 5284.343  3013.76036  1730.50  3283.50   4101.0
#&gt; 40: 2020-04-01 gp_rt 3790.5 4384.195  2697.20831  1442.40  2697.75   3338.4
#&gt; 41: 2020-04-02 gp_rt 4400.0 5102.224  3432.45366  1622.70  2920.75   3750.2
#&gt; 42: 2020-04-03 gp_rt 5059.0 6315.321  4669.92294  1876.65  3410.50   4439.8
#&gt; 43: 2020-04-04 gp_rt 3889.5 4799.742  3464.94137  1313.95  2576.25   3289.2
#&gt; 44: 2020-04-05 gp_rt 4424.5 5771.646  4745.28641  1391.95  2836.75   3756.2
#&gt; 45: 2020-04-06 gp_rt 4083.5 5910.994  7720.80876  1289.90  2552.00   3425.8
#&gt; 46: 2020-04-07 gp_rt 3620.5 5403.050  8411.84641  1112.75  2216.75   2977.4
#&gt; 47: 2020-04-08 gp_rt 2834.5 4951.664 11798.88034   844.40  1757.50   2364.8
#&gt;           date  type median     mean          sd lower_90 lower_50 lower_20
#&gt;     upper_20 upper_50 upper_90
#&gt;  1:     79.0    99.00   148.05
#&gt;  2:    124.0   148.00   233.15
#&gt;  3:    156.0   191.00   293.00
#&gt;  4:    164.0   206.00   307.00
#&gt;  5:    161.0   199.00   322.05
#&gt;  6:    223.0   277.00   447.10
#&gt;  7:    335.4   398.25   633.30
#&gt;  8:    293.4   360.25   550.10
#&gt;  9:    401.0   481.25   731.20
#&gt; 10:    447.0   550.25   853.05
#&gt; 11:    469.0   570.50   880.25
#&gt; 12:    454.2   546.00   838.25
#&gt; 13:    646.8   795.25  1251.70
#&gt; 14:    959.4  1212.50  1859.25
#&gt; 15:    861.8  1057.25  1682.95
#&gt; 16:   1239.0  1562.75  2451.65
#&gt; 17:   1461.4  1788.25  2948.10
#&gt; 18:   1508.4  1839.50  2917.40
#&gt; 19:   1486.2  1809.00  2782.15
#&gt; 20:   2030.4  2547.50  4138.85
#&gt; 21:   3038.0  3802.75  6229.10
#&gt; 22:   2658.6  3322.25  5439.10
#&gt; 23:   3627.2  4450.00  7118.30
#&gt; 24:   3968.0  4766.25  7518.05
#&gt; 25:   4009.4  4893.00  7749.65
#&gt; 26:   3679.0  4593.75  7354.95
#&gt; 27:   4747.2  5730.00  9177.10
#&gt; 28:   6194.6  7686.50 12294.15
#&gt; 29:   4980.8  6182.00  9877.05
#&gt; 30:   6221.4  7531.75 12166.55
#&gt; 31:   6306.6  7725.00 11884.35
#&gt; 32:   5719.6  6909.00 11799.10
#&gt; 33:   4997.2  6071.25  9465.10
#&gt; 34:   5893.4  7244.25 11377.30
#&gt; 35:   7281.8  8831.25 13866.70
#&gt; 36:   5460.4  6979.50 10796.80
#&gt; 37:   6465.6  7931.25 12293.35
#&gt; 38:   6207.8  7401.00 12188.45
#&gt; 39:   5369.2  6601.75 10550.60
#&gt; 40:   4381.8  5522.50  9152.70
#&gt; 41:   4943.2  6210.75 11206.40
#&gt; 42:   6028.8  7889.00 13717.75
#&gt; 43:   4559.6  5983.25 11430.45
#&gt; 44:   5286.4  7034.25 15371.25
#&gt; 45:   4880.8  6749.00 15550.85
#&gt; 46:   4332.8  5983.75 14599.25
#&gt; 47:   3487.0  4966.75 13170.75
#&gt;     upper_20 upper_50 upper_90
#&gt; 
#&gt; 
#&gt; $summary
#&gt;                                  measure              estimate
#&gt; 1: New confirmed cases by infection date   2517 (262 -- 18833)
#&gt; 2:        Expected change in daily cases                Unsure
#&gt; 3:            Effective reproduction no.      0.7 (0.2 -- 1.7)
#&gt; 4:                        Rate of growth -0.08 (-0.25 -- 0.18)
#&gt; 5:          Doubling/halving time (days)    -8.7 (3.9 -- -2.7)
#&gt;     numeric_estimate
#&gt; 1: &lt;data.table[1x9]&gt;
#&gt; 2:              0.76
#&gt; 3: &lt;data.table[1x9]&gt;
#&gt; 4: &lt;data.table[1x9]&gt;
#&gt; 5: &lt;data.table[1x9]&gt;
#&gt; 
#&gt; $plots
#&gt; $plots$infections</div><div class='img'><img src='epinow-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; 
#&gt; $plots$reports</div><div class='img'><img src='epinow-2.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; 
#&gt; $plots$reff</div><div class='img'><img src='epinow-3.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; 
#&gt; $plots$growth_rate</div><div class='img'><img src='epinow-4.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; 
#&gt; $plots$summary</div><div class='img'><img src='epinow-5.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; 
#&gt; </div><div class='input'>
<span class='co'># optional forecasting using EpiSoon plug-in</span>
<span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/ns-load.html'>requireNamespace</a></span><span class='op'>(</span><span class='st'>"EpiSoon"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
   <span class='kw'>if</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/ns-load.html'>requireNamespace</a></span><span class='op'>(</span><span class='st'>"forecastHybrid"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
   <span class='co'># report Rt along with forecasts</span>
   <span class='va'>out</span> <span class='op'>&lt;-</span> <span class='fu'>epinow</span><span class='op'>(</span>reported_cases <span class='op'>=</span> <span class='va'>reported_cases</span>, samples <span class='op'>=</span> <span class='fl'>200</span>,
                 generation_time <span class='op'>=</span> <span class='va'>generation_time</span>, 
                 delays <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>incubation_period</span>, <span class='va'>reporting_delay</span><span class='op'>)</span>,
                 forecast_args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
                     forecast_model <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>y</span>, <span class='va'>...</span><span class='op'>)</span><span class='op'>{</span>
                     <span class='fu'>EpiSoon</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/EpiSoon/man/forecastHybrid_model.html'>forecastHybrid_model</a></span><span class='op'>(</span>
                          y <span class='op'>=</span> <span class='va'>y</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>21</span><span class='op'>)</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span><span class='op'>]</span>,
                          model_params <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>models <span class='op'>=</span> <span class='st'>"aefz"</span>, weights <span class='op'>=</span> <span class='st'>"equal"</span><span class='op'>)</span>,
                          forecast_params <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>PI.combination <span class='op'>=</span> <span class='st'>"mean"</span><span class='op'>)</span>, <span class='va'>...</span><span class='op'>)</span><span class='op'>}</span>
                          <span class='op'>)</span>,
                 stan_args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>warmup <span class='op'>=</span> <span class='fl'>200</span>, cores <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='fl'>4</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
    <span class='va'>out</span>
   <span class='op'>}</span>
<span class='op'>}</span>
</div><div class='output co'>#&gt; <span class='message'>Loading required namespace: EpiSoon</span></div><div class='output co'>#&gt; <span class='message'>Loading required namespace: forecastHybrid</span></div><div class='output co'>#&gt; <span class='message'>Registered S3 method overwritten by 'quantmod':</span>
#&gt; <span class='message'>  method            from</span>
#&gt; <span class='message'>  as.zoo.data.frame zoo </span></div><div class='output co'>#&gt; <span class='message'>Logging threshold set at INFO for the EpiNow2 logger</span></div><div class='output co'>#&gt; <span class='message'>Writing EpiNow2 logs to: /var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//Rtmp1ykgRW/regional-epinow/2020-04-01.log</span></div><div class='output co'>#&gt; <span class='message'>Logging threshold set at INFO for the EpiNow2.epinow logger</span></div><div class='output co'>#&gt; <span class='message'>Writing EpiNow2.epinow logs to: /var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//Rtmp1ykgRW/epinow/2020-04-01.log</span></div><div class='output co'>#&gt; <span class='message'>Logging threshold set at INFO for the EpiNow2.epinow.estimate_infections logger</span></div><div class='output co'>#&gt; <span class='message'>Writing EpiNow2.epinow.estimate_infections logs to: /var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//Rtmp1ykgRW/epinow-estimate-infections/2020-04-01.log</span></div><div class='output co'>#&gt; WARN [2020-10-16 12:21:51] epinow: The largest R-hat is 1.06, indicating chains have not mixed.
#&gt; Running the chains for more iterations may help. See
#&gt; http://mc-stan.org/misc/warnings.html#r-hat - 
#&gt; WARN [2020-10-16 12:21:51] epinow: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.
#&gt; Running the chains for more iterations may help. See
#&gt; http://mc-stan.org/misc/warnings.html#bulk-ess - 
#&gt; WARN [2020-10-16 12:21:51] epinow: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.
#&gt; Running the chains for more iterations may help. See
#&gt; http://mc-stan.org/misc/warnings.html#tail-ess - </div><div class='output co'>#&gt; <span class='error'>Error in data.table::rbindlist(list(reported_cases_rt$samples[, `:=`(type,     "rt")], reported_cases_cases$samples[, `:=`(type, "case")],     reported_cases_ensemble$samples[, `:=`(type, "ensemble")],     estimates$samples[variable == "reported_cases"][, .(date,         sample, cases = value, type = "gp_rt")]), use.names = TRUE): Column 3 ['cases'] of item 4 is missing in item 1. Use fill=TRUE to fill with NA (NULL for list columns), or use.names=FALSE to ignore column names.</span></div><div class='output co'>#&gt; <span class='message'>Timing stopped at: 352.5 0.435 353.1</span></div><div class='input'><span class='co'># }</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://www.samabbott.co.uk/'>Sam Abbott</a>, Joel Hellewell, Robin Thompson, Katelyn Gostic, Katharine Sherratt, Sophie Meakin, James Munday, Nikos Bosse, Joe Hickson, EpiForecasts, <a href='https://www.lshtm.ac.uk/aboutus/people/funk.sebastian'>Sebastian Funk</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


